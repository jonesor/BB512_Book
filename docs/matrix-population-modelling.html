<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>9 Matrix population modelling | BB512 - Population Biology and Evolution</title>
  <meta name="description" content="Course book for BB512 at the Biology Department, University of Southern Denmark" />
  <meta name="generator" content="bookdown 0.23 and GitBook 2.6.7" />

  <meta property="og:title" content="9 Matrix population modelling | BB512 - Population Biology and Evolution" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Course book for BB512 at the Biology Department, University of Southern Denmark" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="9 Matrix population modelling | BB512 - Population Biology and Evolution" />
  
  <meta name="twitter:description" content="Course book for BB512 at the Biology Department, University of Southern Denmark" />
  

<meta name="author" content="Owen R. Jones (Course Coordinator)" />


<meta name="date" content="2021-08-27" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="life-tables-and-survivorship-types.html"/>
<link rel="next" href="lotka-volterra-competition.html"/>
<script src="libs/header-attrs-2.9/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<link href="libs/tabwid-1.0.0/tabwid.css" rel="stylesheet" />
<style type="text/css">

.warning-box {
  border: 3px solid #e60000;
  margin:  25px;
  padding: 10px 10px 5px 10px;
  border-radius: 6px 6px 6px 6px;
}

.advanced-box {
  border: 3px solid #268bd2;
  margin:  25px;
  padding: 10px 10px 5px 10px;
  border-radius: 6px 6px 6px 6px;
}

.do-something {
  border: 3px solid #803e00;
  margin:  25px;
  padding: 10px 10px 5px 10px;
  border-radius: 6px 6px 6px 6px;
}

</style>





<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">BB852</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Welcome to BB512</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#this-website-and-other-course-materials"><i class="fa fa-check"></i><b>1.1</b> This website and other course materials</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#expectations"><i class="fa fa-check"></i><b>1.2</b> Expectations</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#your-feedback"><i class="fa fa-check"></i><b>1.3</b> Your feedback</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#assessment"><i class="fa fa-check"></i><b>1.4</b> Assessment</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#instructors"><i class="fa fa-check"></i><b>1.5</b> Instructors</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="schedule.html"><a href="schedule.html"><i class="fa fa-check"></i><b>2</b> Schedule</a></li>
<li class="part"><span><b>I Population Biology</b></span></li>
<li class="chapter" data-level="3" data-path="the-legend-of-ambalapuzha.html"><a href="the-legend-of-ambalapuzha.html"><i class="fa fa-check"></i><b>3</b> The legend of Ambalapuzha</a>
<ul>
<li class="chapter" data-level="3.1" data-path="the-legend-of-ambalapuzha.html"><a href="the-legend-of-ambalapuzha.html#animalsplants-not-grains-of-rice."><i class="fa fa-check"></i><b>3.1</b> Animals/plants, not grains of rice.</a></li>
<li class="chapter" data-level="3.2" data-path="the-legend-of-ambalapuzha.html"><a href="the-legend-of-ambalapuzha.html#optional-try-these-calculations-in-r"><i class="fa fa-check"></i><b>3.2</b> Optional: Try these calculations in R</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="geometric-growth.html"><a href="geometric-growth.html"><i class="fa fa-check"></i><b>4</b> Geometric growth</a></li>
<li class="chapter" data-level="5" data-path="stochastic-population-growth.html"><a href="stochastic-population-growth.html"><i class="fa fa-check"></i><b>5</b> Stochastic population growth</a>
<ul>
<li class="chapter" data-level="5.1" data-path="stochastic-population-growth.html"><a href="stochastic-population-growth.html#simulations-in-r"><i class="fa fa-check"></i><b>5.1</b> Simulations in R</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="basic-logistic-population-growth.html"><a href="basic-logistic-population-growth.html"><i class="fa fa-check"></i><b>6</b> Basic logistic population growth</a>
<ul>
<li class="chapter" data-level="6.1" data-path="basic-logistic-population-growth.html"><a href="basic-logistic-population-growth.html#graph-1"><i class="fa fa-check"></i><b>6.1</b> Graph 1</a></li>
<li class="chapter" data-level="6.2" data-path="basic-logistic-population-growth.html"><a href="basic-logistic-population-growth.html#graphs-2-3"><i class="fa fa-check"></i><b>6.2</b> Graphs 2 &amp; 3</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="deeper-into-logistic-growth.html"><a href="deeper-into-logistic-growth.html"><i class="fa fa-check"></i><b>7</b> Deeper into logistic growth</a>
<ul>
<li class="chapter" data-level="7.1" data-path="deeper-into-logistic-growth.html"><a href="deeper-into-logistic-growth.html#different-views-of-the-basic-logistic-growth-model"><i class="fa fa-check"></i><b>7.1</b> Different views of the basic logistic growth model</a></li>
<li class="chapter" data-level="7.2" data-path="deeper-into-logistic-growth.html"><a href="deeper-into-logistic-growth.html#adding-a-time-lag"><i class="fa fa-check"></i><b>7.2</b> Adding a time lag</a></li>
<li class="chapter" data-level="7.3" data-path="deeper-into-logistic-growth.html"><a href="deeper-into-logistic-growth.html#optional-cobweb-diagrams"><i class="fa fa-check"></i><b>7.3</b> Optional: Cobweb diagrams</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="life-tables-and-survivorship-types.html"><a href="life-tables-and-survivorship-types.html"><i class="fa fa-check"></i><b>8</b> Life tables and survivorship types</a></li>
<li class="chapter" data-level="9" data-path="matrix-population-modelling.html"><a href="matrix-population-modelling.html"><i class="fa fa-check"></i><b>9</b> Matrix population modelling</a>
<ul>
<li class="chapter" data-level="9.1" data-path="matrix-population-modelling.html"><a href="matrix-population-modelling.html#your-turn"><i class="fa fa-check"></i><b>9.1</b> Your turn…</a></li>
<li class="chapter" data-level="9.2" data-path="matrix-population-modelling.html"><a href="matrix-population-modelling.html#an-evolutionary-experiment"><i class="fa fa-check"></i><b>9.2</b> An evolutionary experiment</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="lotka-volterra-competition.html"><a href="lotka-volterra-competition.html"><i class="fa fa-check"></i><b>10</b> Lotka-Volterra competition</a>
<ul>
<li class="chapter" data-level="10.0.1" data-path="lotka-volterra-competition.html"><a href="lotka-volterra-competition.html#the-questions"><i class="fa fa-check"></i><b>10.0.1</b> The questions</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="lotka-volterra-predator-prey-dynamics.html"><a href="lotka-volterra-predator-prey-dynamics.html"><i class="fa fa-check"></i><b>11</b> Lotka-Volterra predator-prey dynamics</a>
<ul>
<li class="chapter" data-level="11.0.1" data-path="lotka-volterra-predator-prey-dynamics.html"><a href="lotka-volterra-predator-prey-dynamics.html#reference"><i class="fa fa-check"></i><b>11.0.1</b> Reference</a></li>
</ul></li>
<li class="part"><span><b>II Evolution</b></span></li>
<li class="chapter" data-level="12" data-path="from-population-biology-to-fitness.html"><a href="from-population-biology-to-fitness.html"><i class="fa fa-check"></i><b>12</b> From population biology to fitness</a>
<ul>
<li class="chapter" data-level="12.1" data-path="from-population-biology-to-fitness.html"><a href="from-population-biology-to-fitness.html#an-in-silico-experiment"><i class="fa fa-check"></i><b>12.1</b> An <em>in silico</em> experiment</a></li>
<li class="chapter" data-level="12.2" data-path="from-population-biology-to-fitness.html"><a href="from-population-biology-to-fitness.html#the-link-to-fitness"><i class="fa fa-check"></i><b>12.2</b> The link to fitness</a></li>
<li class="chapter" data-level="12.3" data-path="from-population-biology-to-fitness.html"><a href="from-population-biology-to-fitness.html#introducing-a-trade-off"><i class="fa fa-check"></i><b>12.3</b> Introducing a trade-off</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="bug-hunt-camouflage-netlogo.html"><a href="bug-hunt-camouflage-netlogo.html"><i class="fa fa-check"></i><b>13</b> Bug hunt camouflage (Netlogo)</a>
<ul>
<li class="chapter" data-level="13.1" data-path="bug-hunt-camouflage-netlogo.html"><a href="bug-hunt-camouflage-netlogo.html#getting-started"><i class="fa fa-check"></i><b>13.1</b> Getting started</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="bug-hunt-camouflage-netlogo.html"><a href="bug-hunt-camouflage-netlogo.html#how-the-simulation-works."><i class="fa fa-check"></i><b>13.1.1</b> How the simulation works.</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="bug-hunt-camouflage-netlogo.html"><a href="bug-hunt-camouflage-netlogo.html#questions"><i class="fa fa-check"></i><b>13.2</b> Questions</a></li>
<li class="chapter" data-level="13.3" data-path="bug-hunt-camouflage-netlogo.html"><a href="bug-hunt-camouflage-netlogo.html#details-about-colours-optional"><i class="fa fa-check"></i><b>13.3</b> Details about colours (optional)</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="neutral-or-adaptive-evolution-in-humans.html"><a href="neutral-or-adaptive-evolution-in-humans.html"><i class="fa fa-check"></i><b>14</b> Neutral or adaptive evolution in humans?</a>
<ul>
<li class="chapter" data-level="14.1" data-path="neutral-or-adaptive-evolution-in-humans.html"><a href="neutral-or-adaptive-evolution-in-humans.html#objective"><i class="fa fa-check"></i><b>14.1</b> Objective</a></li>
<li class="chapter" data-level="14.2" data-path="neutral-or-adaptive-evolution-in-humans.html"><a href="neutral-or-adaptive-evolution-in-humans.html#background"><i class="fa fa-check"></i><b>14.2</b> Background</a></li>
<li class="chapter" data-level="14.3" data-path="neutral-or-adaptive-evolution-in-humans.html"><a href="neutral-or-adaptive-evolution-in-humans.html#your-task"><i class="fa fa-check"></i><b>14.3</b> Your task</a></li>
<li class="chapter" data-level="14.4" data-path="neutral-or-adaptive-evolution-in-humans.html"><a href="neutral-or-adaptive-evolution-in-humans.html#the-traits"><i class="fa fa-check"></i><b>14.4</b> The traits</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="hardy-weinberg-equilibrium.html"><a href="hardy-weinberg-equilibrium.html"><i class="fa fa-check"></i><b>15</b> Hardy-Weinberg equilibrium</a>
<ul>
<li class="chapter" data-level="15.1" data-path="hardy-weinberg-equilibrium.html"><a href="hardy-weinberg-equilibrium.html#problem-1."><i class="fa fa-check"></i><b>15.1</b> Problem #1.</a></li>
<li class="chapter" data-level="15.2" data-path="hardy-weinberg-equilibrium.html"><a href="hardy-weinberg-equilibrium.html#problem-2."><i class="fa fa-check"></i><b>15.2</b> Problem #2.</a></li>
<li class="chapter" data-level="15.3" data-path="hardy-weinberg-equilibrium.html"><a href="hardy-weinberg-equilibrium.html#problem-3."><i class="fa fa-check"></i><b>15.3</b> Problem #3.</a></li>
<li class="chapter" data-level="15.4" data-path="hardy-weinberg-equilibrium.html"><a href="hardy-weinberg-equilibrium.html#problem-4."><i class="fa fa-check"></i><b>15.4</b> Problem #4.</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="how-many-eggs-should-a-bird-lay.html"><a href="how-many-eggs-should-a-bird-lay.html"><i class="fa fa-check"></i><b>16</b> How many eggs should a bird lay?</a>
<ul>
<li class="chapter" data-level="16.1" data-path="how-many-eggs-should-a-bird-lay.html"><a href="how-many-eggs-should-a-bird-lay.html#objectives"><i class="fa fa-check"></i><b>16.1</b> Objectives</a></li>
<li class="chapter" data-level="16.2" data-path="how-many-eggs-should-a-bird-lay.html"><a href="how-many-eggs-should-a-bird-lay.html#background-1"><i class="fa fa-check"></i><b>16.2</b> Background</a></li>
<li class="chapter" data-level="16.3" data-path="how-many-eggs-should-a-bird-lay.html"><a href="how-many-eggs-should-a-bird-lay.html#your-task-1"><i class="fa fa-check"></i><b>16.3</b> Your task</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="trade-offs-and-the-force-of-selection.html"><a href="trade-offs-and-the-force-of-selection.html"><i class="fa fa-check"></i><b>17</b> Trade-offs and the force of selection</a>
<ul>
<li class="chapter" data-level="17.1" data-path="trade-offs-and-the-force-of-selection.html"><a href="trade-offs-and-the-force-of-selection.html#objective-1"><i class="fa fa-check"></i><b>17.1</b> Objective</a></li>
<li class="chapter" data-level="17.2" data-path="trade-offs-and-the-force-of-selection.html"><a href="trade-offs-and-the-force-of-selection.html#background-2"><i class="fa fa-check"></i><b>17.2</b> Background</a></li>
<li class="chapter" data-level="17.3" data-path="trade-offs-and-the-force-of-selection.html"><a href="trade-offs-and-the-force-of-selection.html#exploring-different-life-history-strategies"><i class="fa fa-check"></i><b>17.3</b> Exploring different life history strategies</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="making-a-phylogeny.html"><a href="making-a-phylogeny.html"><i class="fa fa-check"></i><b>18</b> Making a phylogeny</a></li>
<li class="chapter" data-level="19" data-path="short-answer-exam-discussion.html"><a href="short-answer-exam-discussion.html"><i class="fa fa-check"></i><b>19</b> Short answer exam discussion</a></li>
<li class="chapter" data-level="20" data-path="the-red-queen-game.html"><a href="the-red-queen-game.html"><i class="fa fa-check"></i><b>20</b> The Red Queen Game</a></li>
<li class="part"><span><b>III Solutions to exercises</b></span></li>
<li class="chapter" data-level="21" data-path="solutions-and-take-home-messages.html"><a href="solutions-and-take-home-messages.html"><i class="fa fa-check"></i><b>21</b> Solutions and “take-home” messages</a>
<ul>
<li class="chapter" data-level="21.1" data-path="solutions-and-take-home-messages.html"><a href="solutions-and-take-home-messages.html#solutions-bug-hunt-camouflage"><i class="fa fa-check"></i><b>21.1</b> Solutions: Bug hunt camouflage</a></li>
<li class="chapter" data-level="21.2" data-path="solutions-and-take-home-messages.html"><a href="solutions-and-take-home-messages.html#solutions-neutral-or-adaptive-evolution-in-humans"><i class="fa fa-check"></i><b>21.2</b> Solutions: Neutral or adaptive evolution in humans</a></li>
<li class="chapter" data-level="21.3" data-path="solutions-and-take-home-messages.html"><a href="solutions-and-take-home-messages.html#making-a-phylogeny-1"><i class="fa fa-check"></i><b>21.3</b> Making a phylogeny</a></li>
<li class="chapter" data-level="21.4" data-path="solutions-and-take-home-messages.html"><a href="solutions-and-take-home-messages.html#short-answer-exam-discussion-1"><i class="fa fa-check"></i><b>21.4</b> Short answer exam discussion</a></li>
<li class="chapter" data-level="21.5" data-path="solutions-and-take-home-messages.html"><a href="solutions-and-take-home-messages.html#the-red-queen-game-1"><i class="fa fa-check"></i><b>21.5</b> The Red Queen game</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">BB512 - Population Biology and Evolution</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="matrix-population-modelling" class="section level1" number="9">
<h1><span class="header-section-number">9</span> Matrix population modelling</h1>
<p>Matrix population models are one of the most commonly used tools in population biology. They are extensively used in population management and conservation for both animals and plants. This practical aims to give you a good understanding of the basics of their construction and use.</p>
<div class="do-something">
<p>
Learning outcomes:
</p>
<ul>
<li>
Competence in constructing life cycle diagrams to represent the life history of real (or theoretical) organisms.
</li>
<li>
Understanding how to parameterise life-cycle diagrams and use them to produce a matrix population model.
</li>
<li>
Competence in using R to calculate a population growth rate and project a population.
</li>
<li>
Understanding how to connect these results to a management question.
</li>
<li>
Understanding the logic of “<em>in silico</em> experiments” to investigate a biological question (mathematical modelling).
</li>
</ul>
</div>
<p>Think of an organism you would like to model the dynamics of. It could be a mammal, a bird, a fish, insect or tree … real or fantasy.</p>
<p>Think about their life cycle, and draw it as a life cycle diagram with circles indicating the stages and arrows representing transitions between stages and reproduction. Next to the arrows, write values for survival probability and fecundity (number of babies) using your biological knowledge.</p>
<p>Things to think about:</p>
<ul>
<li>Is it age based or stage based?</li>
<li>How many stages are there?</li>
<li>If it is stage, how are stages defined? E.g. by size, by development, etc.</li>
<li>Are the survival and fecundity higher in earlier or later life?</li>
<li>Does the organism skip stages?</li>
<li>Does the organism move backwards through the life cycle?</li>
</ul>
<p><img src="BB512_files/figure-html/unnamed-chunk-37-1.png" width="30%" /></p>
<p>Turn this diagram into a matrix population model by filling in a square of survival/fecundity values. There is space below for up to a 4-stage matrix model.</p>
<p><img src="BB512_files/figure-html/unnamed-chunk-38-1.png" width="672" /></p>
<p>Working with matrices is very tedious in Excel. However, in R you can use this information to predict the future dynamics of the population, and estimate population growth rate, and generation time etc.</p>
<p>Open up <strong>RStudio</strong>, and lets see if we can predict future dynamics. First you will need to install a package called <code>popdemo</code>.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="matrix-population-modelling.html#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;popdemo&quot;</span>)</span></code></pre></div>
<p>You only need to install packages once. After thatyou can load the package for use by using the <code>library</code> function.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="matrix-population-modelling.html#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(popdemo)</span></code></pre></div>
<p>You can put your matrix into R like in the example below (change the numbers to match YOUR model). If your model has fewer, or more, stages then you will need to modify the code a bit. Ask for help if you get stuck.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="matrix-population-modelling.html#cb13-1" aria-hidden="true" tabindex="-1"></a>    A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>( <span class="fl">0.00</span>, <span class="fl">0.00</span>, <span class="fl">4.00</span>, <span class="fl">2.00</span>,</span>
<span id="cb13-2"><a href="matrix-population-modelling.html#cb13-2" aria-hidden="true" tabindex="-1"></a>                   <span class="fl">0.10</span>, <span class="fl">0.00</span>, <span class="fl">0.00</span>, <span class="fl">0.00</span>,</span>
<span id="cb13-3"><a href="matrix-population-modelling.html#cb13-3" aria-hidden="true" tabindex="-1"></a>                   <span class="fl">0.50</span>, <span class="fl">0.20</span>, <span class="fl">0.00</span>, <span class="fl">0.00</span>,</span>
<span id="cb13-4"><a href="matrix-population-modelling.html#cb13-4" aria-hidden="true" tabindex="-1"></a>                   <span class="fl">0.00</span>, <span class="fl">0.30</span>, <span class="fl">0.40</span>, <span class="fl">0.30</span>),</span>
<span id="cb13-5"><a href="matrix-population-modelling.html#cb13-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">byrow =</span> <span class="cn">TRUE</span>, <span class="at">nrow =</span> <span class="dv">4</span>)</span></code></pre></div>
<p>And now you can use the project function to project what happens to the population, then plot it. Look at what happens if you log or don’t log the y-axis. First you need to define an initial starting population structure.</p>
<p>In my example, I have 4 stages, so I have 4 values for the initial population sizes. Then I use the <code>popdemo</code> function <code>project</code> to do a population projection for 10 time steps.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="matrix-population-modelling.html#cb14-1" aria-hidden="true" tabindex="-1"></a>initial <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">3</span>)</span>
<span id="cb14-2"><a href="matrix-population-modelling.html#cb14-2" aria-hidden="true" tabindex="-1"></a>pr <span class="ot">&lt;-</span> popdemo<span class="sc">::</span><span class="fu">project</span>(A, <span class="at">vector =</span> initial, <span class="at">time=</span><span class="dv">10</span>)</span></code></pre></div>
<p>Take a look at <code>pr</code>, the projected population. This gives you the total population size, and below that the population sizes in each stage.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="matrix-population-modelling.html#cb15-1" aria-hidden="true" tabindex="-1"></a>pr</span></code></pre></div>
<pre><code>## 1 deterministic population projection over 10 time intervals.
## 
##  [1]   21.0000   28.6000   45.9800   68.7940  110.7142  167.8147  267.2773
##  [8]  408.6193  646.1858  993.7152 1563.8309</code></pre>
<p>You can access the population sizes of the different stages using <code>vec(pr)</code>.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="matrix-population-modelling.html#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vec</span>(pr)</span></code></pre></div>
<pre><code>##              S1       S2        S3        S4
##  [1,]   10.0000  5.00000   3.00000   3.00000
##  [2,]   18.0000  1.00000   6.00000   3.60000
##  [3,]   31.2000  1.80000   9.20000   3.78000
##  [4,]   44.3600  3.12000  15.96000   5.35400
##  [5,]   74.5480  4.43600  22.80400   8.92620
##  [6,]  109.0684  7.45480  38.16120  13.13026
##  [7,]  178.9053 10.90684  56.02516  21.44000
##  [8,]  266.9806 17.89053  91.63403  32.11412
##  [9,]  430.7643 26.69806 137.06842  51.65501
## [10,]  651.5837 43.07643 220.72178  78.33329
## [11,] 1039.5537 65.15837 334.40714 124.71163</code></pre>
<p>Let’s plot this…</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="matrix-population-modelling.html#cb19-1" aria-hidden="true" tabindex="-1"></a>pop <span class="ot">&lt;-</span> <span class="fu">vec</span>(pr)</span>
<span id="cb19-2"><a href="matrix-population-modelling.html#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(pop,<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">log=</span><span class="st">&quot;y&quot;</span>)</span>
<span id="cb19-3"><a href="matrix-population-modelling.html#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>,<span class="at">legend =</span> <span class="fu">colnames</span>(pop),<span class="at">col=</span><span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(pop),<span class="at">lty=</span><span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(pop))</span></code></pre></div>
<p><img src="BB512_files/figure-html/unnamed-chunk-45-1.png" width="672" /></p>
<p>You should see that the population increases exponentially. The population growth rate is the so-called “<em>dominant eigenvalue</em>” of the matrix <strong>A</strong>.</p>
<p>We can ask R for the <em>eigen values</em> and <em>eigen vectors</em>. These are the population growth rate (<span class="math inline">\(\lambda\)</span>) and the stable stage distribution (<em>SSD</em>) and the reproductive values (<em>RV</em>) of the different stages. <em>SSD</em> is the expected <em>proportion</em> of individuals in the different stage classes at equilibrium and <em>RV</em> is the expected number of future offspring by individuals in each stage.</p>
<p>You can see that in this case, using my example values the population is growing 55.74% per year.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="matrix-population-modelling.html#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">eigs</span>(A)</span></code></pre></div>
<pre><code>## $lambda
## [1] 1.557365
## 
## $ss
## [1] 0.66068003 0.04242295 0.21756281 0.07933420
## 
## $rv
## [1] 0.6831674 0.4705100 2.0337794 1.0866656</code></pre>
<div id="your-turn" class="section level2" number="9.1">
<h2><span class="header-section-number">9.1</span> Your turn…</h2>
<ol style="list-style-type: decimal">
<li>by editing the inputs in the code above, make a projection for <strong>your</strong> data.</li>
<li>plot the results (using the R code here)</li>
<li>what is the health of your population?</li>
</ol>
</div>
<div id="an-evolutionary-experiment" class="section level2" number="9.2">
<h2><span class="header-section-number">9.2</span> An evolutionary experiment</h2>
<p>You can think of lambda (population growth rate) as being a measure of fitness. Imagine that some of your population had a mutation that caused them to have, say, 1 extra baby, but at the expense of reduced survival in one of the younger stages. Would this mutation persist in the population?</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="life-tables-and-survivorship-types.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="lotka-volterra-competition.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/jonesor/BB512_Book/edit/master/1_07_matrixModels.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["BB512.pdf", "BB512.epub"],
"search": {
"engine": "lunr",
"options": null
},
"toc": {
"collapse": "section"
},
"split_by": "section"
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
