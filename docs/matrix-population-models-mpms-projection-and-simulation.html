<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>15 Matrix Population Models (MPMs): Projection and Simulation | BB512 - Population Biology and Evolution</title>
  <meta name="description" content="Course book for BB512 at the Biology Department, University of Southern Denmark" />
  <meta name="generator" content="bookdown 0.46 and GitBook 2.6.7" />

  <meta property="og:title" content="15 Matrix Population Models (MPMs): Projection and Simulation | BB512 - Population Biology and Evolution" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Course book for BB512 at the Biology Department, University of Southern Denmark" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="15 Matrix Population Models (MPMs): Projection and Simulation | BB512 - Population Biology and Evolution" />
  
  <meta name="twitter:description" content="Course book for BB512 at the Biology Department, University of Southern Denmark" />
  

<meta name="author" content="Owen R. Jones (Course Coordinator)" />


<meta name="date" content="2026-02-26" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="trade-offs-and-the-declining-force-of-selection.html"/>
<link rel="next" href="part-3.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/tabwid-1.1.3/tabwid.css" rel="stylesheet" />
<script src="libs/tabwid-1.1.3/tabwid.js"></script>
<style type="text/css">

.warning-box {
  border: 3px solid #e60000;
  margin:  25px;
  padding: 10px 10px 5px 10px;
  border-radius: 6px 6px 6px 6px;
}

.advanced-box {
  border: 3px solid #268bd2;
  margin:  25px;
  padding: 10px 10px 5px 10px;
  border-radius: 6px 6px 6px 6px;
}

.do-something {
  border: 3px solid #803e00;
  margin:  25px;
  padding: 10px 10px 5px 10px;
  border-radius: 6px 6px 6px 6px;
}

</style>





<style type="text/css">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">BB512</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Welcome to BB512</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#how-to-use-this-book"><i class="fa fa-check"></i><b>1.1</b> How to use this book</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#parts-overview"><i class="fa fa-check"></i><b>1.2</b> Parts overview</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#this-website-and-other-course-materials"><i class="fa fa-check"></i><b>1.3</b> This website and other course materials</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#expectations"><i class="fa fa-check"></i><b>1.4</b> Expectations</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#assessment"><i class="fa fa-check"></i><b>1.5</b> Assessment</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#instructors"><i class="fa fa-check"></i><b>1.6</b> Instructors</a></li>
<li class="chapter" data-level="1.7" data-path="index.html"><a href="index.html#software"><i class="fa fa-check"></i><b>1.7</b> Software</a>
<ul>
<li class="chapter" data-level="1.7.1" data-path="index.html"><a href="index.html#excel"><i class="fa fa-check"></i><b>1.7.1</b> Excel</a></li>
<li class="chapter" data-level="1.7.2" data-path="index.html"><a href="index.html#r-and-rstudio"><i class="fa fa-check"></i><b>1.7.2</b> R and RStudio</a></li>
</ul></li>
<li class="chapter" data-level="1.8" data-path="index.html"><a href="index.html#schedule"><i class="fa fa-check"></i><b>1.8</b> Schedule</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-1.html"><a href="part-1.html"><i class="fa fa-check"></i>Part 1: Evolution by Natural Selection</a></li>
<li class="chapter" data-level="2" data-path="the-blind-watchmaker.html"><a href="the-blind-watchmaker.html"><i class="fa fa-check"></i><b>2</b> The Blind Watchmaker</a>
<ul>
<li class="chapter" data-level="2.1" data-path="the-blind-watchmaker.html"><a href="the-blind-watchmaker.html#background"><i class="fa fa-check"></i><b>2.1</b> Background</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="the-blind-watchmaker.html"><a href="the-blind-watchmaker.html#randomness-and-selection"><i class="fa fa-check"></i><b>2.1.1</b> Randomness and Selection</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="the-blind-watchmaker.html"><a href="the-blind-watchmaker.html#learning-outcomes"><i class="fa fa-check"></i><b>2.2</b> Learning outcomes</a></li>
<li class="chapter" data-level="2.3" data-path="the-blind-watchmaker.html"><a href="the-blind-watchmaker.html#worked-example"><i class="fa fa-check"></i><b>2.3</b> Worked example</a></li>
<li class="chapter" data-level="2.4" data-path="the-blind-watchmaker.html"><a href="the-blind-watchmaker.html#your-task"><i class="fa fa-check"></i><b>2.4</b> Your task</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="the-blind-watchmaker.html"><a href="the-blind-watchmaker.html#the-code"><i class="fa fa-check"></i><b>2.4.1</b> The code</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="the-blind-watchmaker.html"><a href="the-blind-watchmaker.html#how-the-simulation-works."><i class="fa fa-check"></i><b>2.5</b> How the simulation works.</a></li>
<li class="chapter" data-level="2.6" data-path="the-blind-watchmaker.html"><a href="the-blind-watchmaker.html#questions"><i class="fa fa-check"></i><b>2.6</b> Questions</a></li>
<li class="chapter" data-level="2.7" data-path="the-blind-watchmaker.html"><a href="the-blind-watchmaker.html#takeaways"><i class="fa fa-check"></i><b>2.7</b> Takeaways</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="bug-hunt-camouflage-netlogo.html"><a href="bug-hunt-camouflage-netlogo.html"><i class="fa fa-check"></i><b>3</b> Bug hunt camouflage (NetLogo)</a>
<ul>
<li class="chapter" data-level="3.1" data-path="bug-hunt-camouflage-netlogo.html"><a href="bug-hunt-camouflage-netlogo.html#background-1"><i class="fa fa-check"></i><b>3.1</b> Background</a></li>
<li class="chapter" data-level="3.2" data-path="bug-hunt-camouflage-netlogo.html"><a href="bug-hunt-camouflage-netlogo.html#learning-outcomes-1"><i class="fa fa-check"></i><b>3.2</b> Learning outcomes</a></li>
<li class="chapter" data-level="3.3" data-path="bug-hunt-camouflage-netlogo.html"><a href="bug-hunt-camouflage-netlogo.html#your-task-1"><i class="fa fa-check"></i><b>3.3</b> Your task</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="bug-hunt-camouflage-netlogo.html"><a href="bug-hunt-camouflage-netlogo.html#getting-started"><i class="fa fa-check"></i><b>3.3.1</b> Getting started</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="bug-hunt-camouflage-netlogo.html"><a href="bug-hunt-camouflage-netlogo.html#questions-1"><i class="fa fa-check"></i><b>3.4</b> Questions</a></li>
<li class="chapter" data-level="3.5" data-path="bug-hunt-camouflage-netlogo.html"><a href="bug-hunt-camouflage-netlogo.html#worked-example-1"><i class="fa fa-check"></i><b>3.5</b> Worked example</a></li>
<li class="chapter" data-level="3.6" data-path="bug-hunt-camouflage-netlogo.html"><a href="bug-hunt-camouflage-netlogo.html#details-about-colours-optional"><i class="fa fa-check"></i><b>3.6</b> Details about colours (optional)</a></li>
<li class="chapter" data-level="3.7" data-path="bug-hunt-camouflage-netlogo.html"><a href="bug-hunt-camouflage-netlogo.html#takeaways-1"><i class="fa fa-check"></i><b>3.7</b> Takeaways</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-2.html"><a href="part-2.html"><i class="fa fa-check"></i>Part 2: Population Growth Models</a></li>
<li class="chapter" data-level="4" data-path="geometric-growth.html"><a href="geometric-growth.html"><i class="fa fa-check"></i><b>4</b> Geometric growth</a>
<ul>
<li class="chapter" data-level="4.1" data-path="geometric-growth.html"><a href="geometric-growth.html#background-2"><i class="fa fa-check"></i><b>4.1</b> Background</a></li>
<li class="chapter" data-level="4.2" data-path="geometric-growth.html"><a href="geometric-growth.html#worked-example-2"><i class="fa fa-check"></i><b>4.2</b> Worked example</a></li>
<li class="chapter" data-level="4.3" data-path="geometric-growth.html"><a href="geometric-growth.html#your-task-2"><i class="fa fa-check"></i><b>4.3</b> Your task</a></li>
<li class="chapter" data-level="4.4" data-path="geometric-growth.html"><a href="geometric-growth.html#questions-2"><i class="fa fa-check"></i><b>4.4</b> Questions</a></li>
<li class="chapter" data-level="4.5" data-path="geometric-growth.html"><a href="geometric-growth.html#takeaways-2"><i class="fa fa-check"></i><b>4.5</b> Takeaways</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="estimating-population-growth-rate.html"><a href="estimating-population-growth-rate.html"><i class="fa fa-check"></i><b>5</b> Estimating Population Growth Rate</a>
<ul>
<li class="chapter" data-level="5.1" data-path="estimating-population-growth-rate.html"><a href="estimating-population-growth-rate.html#background-3"><i class="fa fa-check"></i><b>5.1</b> Background</a></li>
<li class="chapter" data-level="5.2" data-path="estimating-population-growth-rate.html"><a href="estimating-population-growth-rate.html#worked-example-3"><i class="fa fa-check"></i><b>5.2</b> Worked example</a></li>
<li class="chapter" data-level="5.3" data-path="estimating-population-growth-rate.html"><a href="estimating-population-growth-rate.html#your-task-3"><i class="fa fa-check"></i><b>5.3</b> Your task</a></li>
<li class="chapter" data-level="5.4" data-path="estimating-population-growth-rate.html"><a href="estimating-population-growth-rate.html#questions-3"><i class="fa fa-check"></i><b>5.4</b> Questions</a></li>
<li class="chapter" data-level="5.5" data-path="estimating-population-growth-rate.html"><a href="estimating-population-growth-rate.html#takeaways-3"><i class="fa fa-check"></i><b>5.5</b> Takeaways</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="stochastic-population-growth.html"><a href="stochastic-population-growth.html"><i class="fa fa-check"></i><b>6</b> Stochastic population growth</a>
<ul>
<li class="chapter" data-level="6.1" data-path="stochastic-population-growth.html"><a href="stochastic-population-growth.html#background-4"><i class="fa fa-check"></i><b>6.1</b> Background</a></li>
<li class="chapter" data-level="6.2" data-path="stochastic-population-growth.html"><a href="stochastic-population-growth.html#worked-example-4"><i class="fa fa-check"></i><b>6.2</b> Worked example</a></li>
<li class="chapter" data-level="6.3" data-path="stochastic-population-growth.html"><a href="stochastic-population-growth.html#your-task-4"><i class="fa fa-check"></i><b>6.3</b> Your task</a></li>
<li class="chapter" data-level="6.4" data-path="stochastic-population-growth.html"><a href="stochastic-population-growth.html#simulations-in-r"><i class="fa fa-check"></i><b>6.4</b> Simulations in R</a></li>
<li class="chapter" data-level="6.5" data-path="stochastic-population-growth.html"><a href="stochastic-population-growth.html#questions-4"><i class="fa fa-check"></i><b>6.5</b> Questions</a></li>
<li class="chapter" data-level="6.6" data-path="stochastic-population-growth.html"><a href="stochastic-population-growth.html#takeaways-4"><i class="fa fa-check"></i><b>6.6</b> Takeaways</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="basic-logistic-population-growth.html"><a href="basic-logistic-population-growth.html"><i class="fa fa-check"></i><b>7</b> Basic logistic population growth</a>
<ul>
<li class="chapter" data-level="7.1" data-path="basic-logistic-population-growth.html"><a href="basic-logistic-population-growth.html#background-5"><i class="fa fa-check"></i><b>7.1</b> Background</a></li>
<li class="chapter" data-level="7.2" data-path="basic-logistic-population-growth.html"><a href="basic-logistic-population-growth.html#worked-example-5"><i class="fa fa-check"></i><b>7.2</b> Worked example</a></li>
<li class="chapter" data-level="7.3" data-path="basic-logistic-population-growth.html"><a href="basic-logistic-population-growth.html#your-task-5"><i class="fa fa-check"></i><b>7.3</b> Your Task</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="basic-logistic-population-growth.html"><a href="basic-logistic-population-growth.html#graph-1-population-size-through-time"><i class="fa fa-check"></i><b>7.3.1</b> Graph 1: Population Size Through Time</a></li>
<li class="chapter" data-level="7.3.2" data-path="basic-logistic-population-growth.html"><a href="basic-logistic-population-growth.html#graph-2-per-capita-growth-rate-vs.-population-size"><i class="fa fa-check"></i><b>7.3.2</b> Graph 2: Per Capita Growth Rate vs. Population Size</a></li>
<li class="chapter" data-level="7.3.3" data-path="basic-logistic-population-growth.html"><a href="basic-logistic-population-growth.html#reflection-on-graph-2"><i class="fa fa-check"></i><b>7.3.3</b> Reflection on Graph 2</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="basic-logistic-population-growth.html"><a href="basic-logistic-population-growth.html#takeaways-5"><i class="fa fa-check"></i><b>7.4</b> Takeaways</a></li>
<li class="chapter" data-level="7.5" data-path="basic-logistic-population-growth.html"><a href="basic-logistic-population-growth.html#questions-5"><i class="fa fa-check"></i><b>7.5</b> Questions</a></li>
<li class="chapter" data-level="7.6" data-path="basic-logistic-population-growth.html"><a href="basic-logistic-population-growth.html#optional-do-this-in-r."><i class="fa fa-check"></i><b>7.6</b> Optional: Do this in R.</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="deeper-into-logistic-growth.html"><a href="deeper-into-logistic-growth.html"><i class="fa fa-check"></i><b>8</b> Deeper into Logistic Growth</a>
<ul>
<li class="chapter" data-level="8.1" data-path="deeper-into-logistic-growth.html"><a href="deeper-into-logistic-growth.html#background-6"><i class="fa fa-check"></i><b>8.1</b> Background</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="deeper-into-logistic-growth.html"><a href="deeper-into-logistic-growth.html#linking-logistic-and-exponential-growth-models"><i class="fa fa-check"></i><b>8.1.1</b> Linking Logistic and Exponential Growth Models</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="deeper-into-logistic-growth.html"><a href="deeper-into-logistic-growth.html#worked-example-6"><i class="fa fa-check"></i><b>8.2</b> Worked example</a></li>
<li class="chapter" data-level="8.3" data-path="deeper-into-logistic-growth.html"><a href="deeper-into-logistic-growth.html#your-task-6"><i class="fa fa-check"></i><b>8.3</b> Your Task</a></li>
<li class="chapter" data-level="8.4" data-path="deeper-into-logistic-growth.html"><a href="deeper-into-logistic-growth.html#questions-6"><i class="fa fa-check"></i><b>8.4</b> Questions</a></li>
<li class="chapter" data-level="8.5" data-path="deeper-into-logistic-growth.html"><a href="deeper-into-logistic-growth.html#takeaways-6"><i class="fa fa-check"></i><b>8.5</b> Takeaways</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="life-tables-and-survivorship-types.html"><a href="life-tables-and-survivorship-types.html"><i class="fa fa-check"></i><b>9</b> Life tables and survivorship types</a>
<ul>
<li class="chapter" data-level="9.1" data-path="life-tables-and-survivorship-types.html"><a href="life-tables-and-survivorship-types.html#background-7"><i class="fa fa-check"></i><b>9.1</b> Background</a></li>
<li class="chapter" data-level="9.2" data-path="life-tables-and-survivorship-types.html"><a href="life-tables-and-survivorship-types.html#worked-example-7"><i class="fa fa-check"></i><b>9.2</b> Worked example</a></li>
<li class="chapter" data-level="9.3" data-path="life-tables-and-survivorship-types.html"><a href="life-tables-and-survivorship-types.html#your-task-7"><i class="fa fa-check"></i><b>9.3</b> Your task</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="life-tables-and-survivorship-types.html"><a href="life-tables-and-survivorship-types.html#life-table"><i class="fa fa-check"></i><b>9.3.1</b> Life table</a></li>
<li class="chapter" data-level="9.3.2" data-path="life-tables-and-survivorship-types.html"><a href="life-tables-and-survivorship-types.html#survivorship-curves"><i class="fa fa-check"></i><b>9.3.2</b> Survivorship curves</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="life-tables-and-survivorship-types.html"><a href="life-tables-and-survivorship-types.html#questions-7"><i class="fa fa-check"></i><b>9.4</b> Questions</a></li>
<li class="chapter" data-level="9.5" data-path="life-tables-and-survivorship-types.html"><a href="life-tables-and-survivorship-types.html#takeaways-7"><i class="fa fa-check"></i><b>9.5</b> Takeaways</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="matrix-population-modelling.html"><a href="matrix-population-modelling.html"><i class="fa fa-check"></i><b>10</b> Matrix population modelling</a>
<ul>
<li class="chapter" data-level="10.1" data-path="matrix-population-modelling.html"><a href="matrix-population-modelling.html#background-8"><i class="fa fa-check"></i><b>10.1</b> Background</a></li>
<li class="chapter" data-level="10.2" data-path="matrix-population-modelling.html"><a href="matrix-population-modelling.html#your-task-8"><i class="fa fa-check"></i><b>10.2</b> Your task</a></li>
<li class="chapter" data-level="10.3" data-path="matrix-population-modelling.html"><a href="matrix-population-modelling.html#using-r-for-matrix-modelling"><i class="fa fa-check"></i><b>10.3</b> Using R for matrix modelling</a></li>
<li class="chapter" data-level="10.4" data-path="matrix-population-modelling.html"><a href="matrix-population-modelling.html#projecting-the-population"><i class="fa fa-check"></i><b>10.4</b> Projecting the population</a></li>
<li class="chapter" data-level="10.5" data-path="matrix-population-modelling.html"><a href="matrix-population-modelling.html#elasticity"><i class="fa fa-check"></i><b>10.5</b> Elasticity</a></li>
<li class="chapter" data-level="10.6" data-path="matrix-population-modelling.html"><a href="matrix-population-modelling.html#life-table-response-experiment-ltre"><i class="fa fa-check"></i><b>10.6</b> Life table response experiment (LTRE)</a></li>
<li class="chapter" data-level="10.7" data-path="matrix-population-modelling.html"><a href="matrix-population-modelling.html#your-turn"><i class="fa fa-check"></i><b>10.7</b> Your turn…</a>
<ul>
<li class="chapter" data-level="10.7.1" data-path="matrix-population-modelling.html"><a href="matrix-population-modelling.html#an-evolutionary-experiment"><i class="fa fa-check"></i><b>10.7.1</b> An evolutionary experiment</a></li>
<li class="chapter" data-level="10.7.2" data-path="matrix-population-modelling.html"><a href="matrix-population-modelling.html#questions-8"><i class="fa fa-check"></i><b>10.7.2</b> Questions</a></li>
</ul></li>
<li class="chapter" data-level="10.8" data-path="matrix-population-modelling.html"><a href="matrix-population-modelling.html#takeaways-8"><i class="fa fa-check"></i><b>10.8</b> Takeaways</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="pre--and-post-reproduction-census.html"><a href="pre--and-post-reproduction-census.html"><i class="fa fa-check"></i><b>11</b> Pre- and Post-reproduction census</a>
<ul>
<li class="chapter" data-level="11.1" data-path="pre--and-post-reproduction-census.html"><a href="pre--and-post-reproduction-census.html#background-9"><i class="fa fa-check"></i><b>11.1</b> Background</a></li>
<li class="chapter" data-level="11.2" data-path="pre--and-post-reproduction-census.html"><a href="pre--and-post-reproduction-census.html#learning-outcomes-2"><i class="fa fa-check"></i><b>11.2</b> Learning outcomes</a></li>
<li class="chapter" data-level="11.3" data-path="pre--and-post-reproduction-census.html"><a href="pre--and-post-reproduction-census.html#worked-example-8"><i class="fa fa-check"></i><b>11.3</b> Worked example</a></li>
<li class="chapter" data-level="11.4" data-path="pre--and-post-reproduction-census.html"><a href="pre--and-post-reproduction-census.html#your-task-9"><i class="fa fa-check"></i><b>11.4</b> Your task</a></li>
<li class="chapter" data-level="11.5" data-path="pre--and-post-reproduction-census.html"><a href="pre--and-post-reproduction-census.html#takeaways-9"><i class="fa fa-check"></i><b>11.5</b> Takeaways</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="life-table-response-experiments.html"><a href="life-table-response-experiments.html"><i class="fa fa-check"></i><b>12</b> Life Table Response Experiments</a>
<ul>
<li class="chapter" data-level="12.1" data-path="life-table-response-experiments.html"><a href="life-table-response-experiments.html#introduction"><i class="fa fa-check"></i><b>12.1</b> Introduction</a></li>
<li class="chapter" data-level="12.2" data-path="life-table-response-experiments.html"><a href="life-table-response-experiments.html#learning-outcomes-3"><i class="fa fa-check"></i><b>12.2</b> Learning outcomes</a></li>
<li class="chapter" data-level="12.3" data-path="life-table-response-experiments.html"><a href="life-table-response-experiments.html#set-up"><i class="fa fa-check"></i><b>12.3</b> Set up</a></li>
<li class="chapter" data-level="12.4" data-path="life-table-response-experiments.html"><a href="life-table-response-experiments.html#a-worked-example"><i class="fa fa-check"></i><b>12.4</b> A worked example</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="life-table-response-experiments.html"><a href="life-table-response-experiments.html#comparing-matrices"><i class="fa fa-check"></i><b>12.4.1</b> Comparing matrices</a></li>
<li class="chapter" data-level="12.4.2" data-path="life-table-response-experiments.html"><a href="life-table-response-experiments.html#contributions-from-individual-matrix-elements"><i class="fa fa-check"></i><b>12.4.2</b> Contributions from individual matrix elements</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="life-table-response-experiments.html"><a href="life-table-response-experiments.html#relationship-with-elasticity-analysis"><i class="fa fa-check"></i><b>12.5</b> Relationship with elasticity analysis</a></li>
<li class="chapter" data-level="12.6" data-path="life-table-response-experiments.html"><a href="life-table-response-experiments.html#your-task-10"><i class="fa fa-check"></i><b>12.6</b> Your task</a></li>
<li class="chapter" data-level="12.7" data-path="life-table-response-experiments.html"><a href="life-table-response-experiments.html#takeaways-10"><i class="fa fa-check"></i><b>12.7</b> Takeaways</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="how-many-eggs-should-a-bird-lay.html"><a href="how-many-eggs-should-a-bird-lay.html"><i class="fa fa-check"></i><b>13</b> How many eggs should a bird lay?</a>
<ul>
<li class="chapter" data-level="13.1" data-path="how-many-eggs-should-a-bird-lay.html"><a href="how-many-eggs-should-a-bird-lay.html#background-10"><i class="fa fa-check"></i><b>13.1</b> Background</a></li>
<li class="chapter" data-level="13.2" data-path="how-many-eggs-should-a-bird-lay.html"><a href="how-many-eggs-should-a-bird-lay.html#worked-example-9"><i class="fa fa-check"></i><b>13.2</b> Worked example</a></li>
<li class="chapter" data-level="13.3" data-path="how-many-eggs-should-a-bird-lay.html"><a href="how-many-eggs-should-a-bird-lay.html#your-task-11"><i class="fa fa-check"></i><b>13.3</b> Your task</a></li>
<li class="chapter" data-level="13.4" data-path="how-many-eggs-should-a-bird-lay.html"><a href="how-many-eggs-should-a-bird-lay.html#questions-9"><i class="fa fa-check"></i><b>13.4</b> Questions</a></li>
<li class="chapter" data-level="13.5" data-path="how-many-eggs-should-a-bird-lay.html"><a href="how-many-eggs-should-a-bird-lay.html#takeaways-11"><i class="fa fa-check"></i><b>13.5</b> Takeaways</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="trade-offs-and-the-declining-force-of-selection.html"><a href="trade-offs-and-the-declining-force-of-selection.html"><i class="fa fa-check"></i><b>14</b> Trade-offs and the declining force of selection</a>
<ul>
<li class="chapter" data-level="14.1" data-path="trade-offs-and-the-declining-force-of-selection.html"><a href="trade-offs-and-the-declining-force-of-selection.html#background-11"><i class="fa fa-check"></i><b>14.1</b> Background</a></li>
<li class="chapter" data-level="14.2" data-path="trade-offs-and-the-declining-force-of-selection.html"><a href="trade-offs-and-the-declining-force-of-selection.html#worked-example-10"><i class="fa fa-check"></i><b>14.2</b> Worked example</a></li>
<li class="chapter" data-level="14.3" data-path="trade-offs-and-the-declining-force-of-selection.html"><a href="trade-offs-and-the-declining-force-of-selection.html#your-task-12"><i class="fa fa-check"></i><b>14.3</b> Your task</a></li>
<li class="chapter" data-level="14.4" data-path="trade-offs-and-the-declining-force-of-selection.html"><a href="trade-offs-and-the-declining-force-of-selection.html#exploring-different-life-history-strategies"><i class="fa fa-check"></i><b>14.4</b> Exploring different life history strategies</a></li>
<li class="chapter" data-level="14.5" data-path="trade-offs-and-the-declining-force-of-selection.html"><a href="trade-offs-and-the-declining-force-of-selection.html#questions-10"><i class="fa fa-check"></i><b>14.5</b> Questions</a></li>
<li class="chapter" data-level="14.6" data-path="trade-offs-and-the-declining-force-of-selection.html"><a href="trade-offs-and-the-declining-force-of-selection.html#takeaways-12"><i class="fa fa-check"></i><b>14.6</b> Takeaways</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="matrix-population-models-mpms-projection-and-simulation.html"><a href="matrix-population-models-mpms-projection-and-simulation.html"><i class="fa fa-check"></i><b>15</b> Matrix Population Models (MPMs): Projection and Simulation</a>
<ul>
<li class="chapter" data-level="15.1" data-path="matrix-population-models-mpms-projection-and-simulation.html"><a href="matrix-population-models-mpms-projection-and-simulation.html#what-is-a-matrix-population-model"><i class="fa fa-check"></i><b>15.1</b> What is a matrix population model?</a></li>
<li class="chapter" data-level="15.2" data-path="matrix-population-models-mpms-projection-and-simulation.html"><a href="matrix-population-models-mpms-projection-and-simulation.html#the-projection-interval-delta-t"><i class="fa fa-check"></i><b>15.2</b> The projection interval (\(\Delta t\))</a></li>
<li class="chapter" data-level="15.3" data-path="matrix-population-models-mpms-projection-and-simulation.html"><a href="matrix-population-models-mpms-projection-and-simulation.html#the-population-vector"><i class="fa fa-check"></i><b>15.3</b> The population vector</a></li>
<li class="chapter" data-level="15.4" data-path="matrix-population-models-mpms-projection-and-simulation.html"><a href="matrix-population-models-mpms-projection-and-simulation.html#the-projection-matrix"><i class="fa fa-check"></i><b>15.4</b> The projection matrix</a></li>
<li class="chapter" data-level="15.5" data-path="matrix-population-models-mpms-projection-and-simulation.html"><a href="matrix-population-models-mpms-projection-and-simulation.html#a-simple-3-stage-model"><i class="fa fa-check"></i><b>15.5</b> A simple 3-stage model</a></li>
<li class="chapter" data-level="15.6" data-path="matrix-population-models-mpms-projection-and-simulation.html"><a href="matrix-population-models-mpms-projection-and-simulation.html#projection-projecting-mathbfn_t-forward"><i class="fa fa-check"></i><b>15.6</b> Projection: projecting \(\mathbf{n}_t\) forward</a></li>
<li class="chapter" data-level="15.7" data-path="matrix-population-models-mpms-projection-and-simulation.html"><a href="matrix-population-models-mpms-projection-and-simulation.html#define-vital-rates-and-build-mathbfa"><i class="fa fa-check"></i><b>15.7</b> Define vital rates and build \(\mathbf{A}\)</a></li>
<li class="chapter" data-level="15.8" data-path="matrix-population-models-mpms-projection-and-simulation.html"><a href="matrix-population-models-mpms-projection-and-simulation.html#define-an-initial-population-vector-mathbfn_0"><i class="fa fa-check"></i><b>15.8</b> Define an initial population vector \(\mathbf{n}_0\)</a></li>
<li class="chapter" data-level="15.9" data-path="matrix-population-models-mpms-projection-and-simulation.html"><a href="matrix-population-models-mpms-projection-and-simulation.html#one-step-projection"><i class="fa fa-check"></i><b>15.9</b> One-step projection</a></li>
<li class="chapter" data-level="15.10" data-path="matrix-population-models-mpms-projection-and-simulation.html"><a href="matrix-population-models-mpms-projection-and-simulation.html#project-for-many-years-deterministic"><i class="fa fa-check"></i><b>15.10</b> Project for many years (deterministic)</a>
<ul>
<li class="chapter" data-level="15.10.1" data-path="matrix-population-models-mpms-projection-and-simulation.html"><a href="matrix-population-models-mpms-projection-and-simulation.html#plot-totals-and-stage-trajectories"><i class="fa fa-check"></i><b>15.10.1</b> Plot totals and stage trajectories</a></li>
</ul></li>
<li class="chapter" data-level="15.11" data-path="matrix-population-models-mpms-projection-and-simulation.html"><a href="matrix-population-models-mpms-projection-and-simulation.html#long-term-growth-rate-lambda"><i class="fa fa-check"></i><b>15.11</b> Long-term growth rate (\(\lambda\))</a></li>
<li class="chapter" data-level="15.12" data-path="matrix-population-models-mpms-projection-and-simulation.html"><a href="matrix-population-models-mpms-projection-and-simulation.html#simulation-adding-stochasticity-and-management-actions"><i class="fa fa-check"></i><b>15.12</b> Simulation: adding stochasticity and management actions</a>
<ul>
<li class="chapter" data-level="15.12.1" data-path="matrix-population-models-mpms-projection-and-simulation.html"><a href="matrix-population-models-mpms-projection-and-simulation.html#one-simulated-trajectory-no-culling"><i class="fa fa-check"></i><b>15.12.1</b> One simulated trajectory (no culling)</a></li>
<li class="chapter" data-level="15.12.2" data-path="matrix-population-models-mpms-projection-and-simulation.html"><a href="matrix-population-models-mpms-projection-and-simulation.html#add-a-culling-intervention"><i class="fa fa-check"></i><b>15.12.2</b> Add a culling intervention</a></li>
<li class="chapter" data-level="15.12.3" data-path="matrix-population-models-mpms-projection-and-simulation.html"><a href="matrix-population-models-mpms-projection-and-simulation.html#many-replicates-uncertainty-bands"><i class="fa fa-check"></i><b>15.12.3</b> Many replicates (uncertainty bands)</a></li>
</ul></li>
<li class="chapter" data-level="15.13" data-path="matrix-population-models-mpms-projection-and-simulation.html"><a href="matrix-population-models-mpms-projection-and-simulation.html#student-exercises-for-a-class-handout"><i class="fa fa-check"></i><b>15.13</b> Student exercises (for a class handout)</a>
<ul>
<li class="chapter" data-level="15.13.1" data-path="matrix-population-models-mpms-projection-and-simulation.html"><a href="matrix-population-models-mpms-projection-and-simulation.html#exercise-projection-interval-sanity-check"><i class="fa fa-check"></i><b>15.13.1</b> Exercise: Projection interval sanity check</a></li>
<li class="chapter" data-level="15.13.2" data-path="matrix-population-models-mpms-projection-and-simulation.html"><a href="matrix-population-models-mpms-projection-and-simulation.html#exercise-change-one-vital-rate-and-re-run-projections"><i class="fa fa-check"></i><b>15.13.2</b> Exercise: Change one vital rate and re-run projections</a></li>
<li class="chapter" data-level="15.13.3" data-path="matrix-population-models-mpms-projection-and-simulation.html"><a href="matrix-population-models-mpms-projection-and-simulation.html#exercise-culling-as-management"><i class="fa fa-check"></i><b>15.13.3</b> Exercise: Culling as management</a></li>
<li class="chapter" data-level="15.13.4" data-path="matrix-population-models-mpms-projection-and-simulation.html"><a href="matrix-population-models-mpms-projection-and-simulation.html#exercise-contraception-treatment-reduced-fecundity"><i class="fa fa-check"></i><b>15.13.4</b> Exercise: Contraception treatment (reduced fecundity)</a></li>
</ul></li>
<li class="chapter" data-level="15.14" data-path="matrix-population-models-mpms-projection-and-simulation.html"><a href="matrix-population-models-mpms-projection-and-simulation.html#notes-and-extensions"><i class="fa fa-check"></i><b>15.14</b> Notes and extensions</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-3.html"><a href="part-3.html"><i class="fa fa-check"></i>Part 3: Population Genetics and Evolution</a></li>
<li class="chapter" data-level="16" data-path="hardy-weinberg-equilibrium.html"><a href="hardy-weinberg-equilibrium.html"><i class="fa fa-check"></i><b>16</b> Hardy-Weinberg equilibrium</a>
<ul>
<li class="chapter" data-level="16.1" data-path="hardy-weinberg-equilibrium.html"><a href="hardy-weinberg-equilibrium.html#background-12"><i class="fa fa-check"></i><b>16.1</b> Background</a></li>
<li class="chapter" data-level="16.2" data-path="hardy-weinberg-equilibrium.html"><a href="hardy-weinberg-equilibrium.html#assumptions-of-hardy-weinberg-equilibrium"><i class="fa fa-check"></i><b>16.2</b> Assumptions of Hardy-Weinberg Equilibrium</a></li>
<li class="chapter" data-level="16.3" data-path="hardy-weinberg-equilibrium.html"><a href="hardy-weinberg-equilibrium.html#worked-example-11"><i class="fa fa-check"></i><b>16.3</b> Worked example</a></li>
<li class="chapter" data-level="16.4" data-path="hardy-weinberg-equilibrium.html"><a href="hardy-weinberg-equilibrium.html#your-task-13"><i class="fa fa-check"></i><b>16.4</b> Your task</a>
<ul>
<li class="chapter" data-level="16.4.1" data-path="hardy-weinberg-equilibrium.html"><a href="hardy-weinberg-equilibrium.html#problem-1."><i class="fa fa-check"></i><b>16.4.1</b> Problem #1.</a></li>
<li class="chapter" data-level="16.4.2" data-path="hardy-weinberg-equilibrium.html"><a href="hardy-weinberg-equilibrium.html#problem-2."><i class="fa fa-check"></i><b>16.4.2</b> Problem #2.</a></li>
<li class="chapter" data-level="16.4.3" data-path="hardy-weinberg-equilibrium.html"><a href="hardy-weinberg-equilibrium.html#problem-3."><i class="fa fa-check"></i><b>16.4.3</b> Problem #3.</a></li>
<li class="chapter" data-level="16.4.4" data-path="hardy-weinberg-equilibrium.html"><a href="hardy-weinberg-equilibrium.html#problem-4."><i class="fa fa-check"></i><b>16.4.4</b> Problem #4.</a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="hardy-weinberg-equilibrium.html"><a href="hardy-weinberg-equilibrium.html#takeaways-13"><i class="fa fa-check"></i><b>16.5</b> Takeaways</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="the-gene-pool-model.html"><a href="the-gene-pool-model.html"><i class="fa fa-check"></i><b>17</b> The Gene Pool Model</a>
<ul>
<li class="chapter" data-level="17.1" data-path="the-gene-pool-model.html"><a href="the-gene-pool-model.html#background-13"><i class="fa fa-check"></i><b>17.1</b> Background</a></li>
<li class="chapter" data-level="17.2" data-path="the-gene-pool-model.html"><a href="the-gene-pool-model.html#worked-example-12"><i class="fa fa-check"></i><b>17.2</b> Worked example</a></li>
<li class="chapter" data-level="17.3" data-path="the-gene-pool-model.html"><a href="the-gene-pool-model.html#your-task-14"><i class="fa fa-check"></i><b>17.3</b> Your task</a></li>
<li class="chapter" data-level="17.4" data-path="the-gene-pool-model.html"><a href="the-gene-pool-model.html#a-simple-model"><i class="fa fa-check"></i><b>17.4</b> A simple model</a>
<ul>
<li class="chapter" data-level="17.4.1" data-path="the-gene-pool-model.html"><a href="the-gene-pool-model.html#the-gene-pool"><i class="fa fa-check"></i><b>17.4.1</b> The gene pool</a></li>
<li class="chapter" data-level="17.4.2" data-path="the-gene-pool-model.html"><a href="the-gene-pool-model.html#projecting-allele-frequency-over-one-time-step."><i class="fa fa-check"></i><b>17.4.2</b> Projecting allele frequency over one time step.</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="the-gene-pool-model.html"><a href="the-gene-pool-model.html#simulation-of-allele-frequency-through-time"><i class="fa fa-check"></i><b>17.5</b> Simulation of allele frequency through time</a></li>
<li class="chapter" data-level="17.6" data-path="the-gene-pool-model.html"><a href="the-gene-pool-model.html#bottlenecks"><i class="fa fa-check"></i><b>17.6</b> Bottlenecks</a></li>
<li class="chapter" data-level="17.7" data-path="the-gene-pool-model.html"><a href="the-gene-pool-model.html#conclusions"><i class="fa fa-check"></i><b>17.7</b> Conclusions</a></li>
<li class="chapter" data-level="17.8" data-path="the-gene-pool-model.html"><a href="the-gene-pool-model.html#takeaways-14"><i class="fa fa-check"></i><b>17.8</b> Takeaways</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="neutral-or-adaptive-evolution-in-humans-what-drives-evolution-of-our-traits.html"><a href="neutral-or-adaptive-evolution-in-humans-what-drives-evolution-of-our-traits.html"><i class="fa fa-check"></i><b>18</b> Neutral or Adaptive Evolution in Humans: What Drives Evolution of Our Traits?</a>
<ul>
<li class="chapter" data-level="18.1" data-path="neutral-or-adaptive-evolution-in-humans-what-drives-evolution-of-our-traits.html"><a href="neutral-or-adaptive-evolution-in-humans-what-drives-evolution-of-our-traits.html#background-14"><i class="fa fa-check"></i><b>18.1</b> Background</a></li>
<li class="chapter" data-level="18.2" data-path="neutral-or-adaptive-evolution-in-humans-what-drives-evolution-of-our-traits.html"><a href="neutral-or-adaptive-evolution-in-humans-what-drives-evolution-of-our-traits.html#worked-example-13"><i class="fa fa-check"></i><b>18.2</b> Worked example</a></li>
<li class="chapter" data-level="18.3" data-path="neutral-or-adaptive-evolution-in-humans-what-drives-evolution-of-our-traits.html"><a href="neutral-or-adaptive-evolution-in-humans-what-drives-evolution-of-our-traits.html#your-task-30-minutes"><i class="fa fa-check"></i><b>18.3</b> Your task (30 minutes)</a>
<ul>
<li class="chapter" data-level="18.3.1" data-path="neutral-or-adaptive-evolution-in-humans-what-drives-evolution-of-our-traits.html"><a href="neutral-or-adaptive-evolution-in-humans-what-drives-evolution-of-our-traits.html#the-traits"><i class="fa fa-check"></i><b>18.3.1</b> The traits</a></li>
</ul></li>
<li class="chapter" data-level="18.4" data-path="neutral-or-adaptive-evolution-in-humans-what-drives-evolution-of-our-traits.html"><a href="neutral-or-adaptive-evolution-in-humans-what-drives-evolution-of-our-traits.html#discussion-timing-15-minutes"><i class="fa fa-check"></i><b>18.4</b> Discussion (Timing: 15 minutes)</a></li>
<li class="chapter" data-level="18.5" data-path="neutral-or-adaptive-evolution-in-humans-what-drives-evolution-of-our-traits.html"><a href="neutral-or-adaptive-evolution-in-humans-what-drives-evolution-of-our-traits.html#takeaways-15"><i class="fa fa-check"></i><b>18.5</b> Takeaways</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="heritability-from-a-linear-regression.html"><a href="heritability-from-a-linear-regression.html"><i class="fa fa-check"></i><b>19</b> Heritability from a linear regression</a>
<ul>
<li class="chapter" data-level="19.1" data-path="heritability-from-a-linear-regression.html"><a href="heritability-from-a-linear-regression.html#background-15"><i class="fa fa-check"></i><b>19.1</b> Background</a></li>
<li class="chapter" data-level="19.2" data-path="heritability-from-a-linear-regression.html"><a href="heritability-from-a-linear-regression.html#worked-example-14"><i class="fa fa-check"></i><b>19.2</b> Worked example</a></li>
<li class="chapter" data-level="19.3" data-path="heritability-from-a-linear-regression.html"><a href="heritability-from-a-linear-regression.html#your-task-15"><i class="fa fa-check"></i><b>19.3</b> Your Task</a>
<ul>
<li class="chapter" data-level="19.3.1" data-path="heritability-from-a-linear-regression.html"><a href="heritability-from-a-linear-regression.html#estimating-heritability-15-minutes"><i class="fa fa-check"></i><b>19.3.1</b> Estimating heritability (15 minutes)</a></li>
<li class="chapter" data-level="19.3.2" data-path="heritability-from-a-linear-regression.html"><a href="heritability-from-a-linear-regression.html#comparative-analysis-10-minutes"><i class="fa fa-check"></i><b>19.3.2</b> Comparative Analysis (10 minutes)</a></li>
<li class="chapter" data-level="19.3.3" data-path="heritability-from-a-linear-regression.html"><a href="heritability-from-a-linear-regression.html#assumptions-10-mins"><i class="fa fa-check"></i><b>19.3.3</b> Assumptions (10 mins)</a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="heritability-from-a-linear-regression.html"><a href="heritability-from-a-linear-regression.html#takeaways-16"><i class="fa fa-check"></i><b>19.4</b> Takeaways</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-4.html"><a href="part-4.html"><i class="fa fa-check"></i>Part 4: Interactions Between Species and Community Structure</a></li>
<li class="chapter" data-level="20" data-path="lotka-volterra-competition.html"><a href="lotka-volterra-competition.html"><i class="fa fa-check"></i><b>20</b> Lotka-Volterra competition</a>
<ul>
<li class="chapter" data-level="20.1" data-path="lotka-volterra-competition.html"><a href="lotka-volterra-competition.html#worked-example-15"><i class="fa fa-check"></i><b>20.1</b> Worked example</a></li>
<li class="chapter" data-level="20.2" data-path="lotka-volterra-competition.html"><a href="lotka-volterra-competition.html#your-task-16"><i class="fa fa-check"></i><b>20.2</b> Your task</a>
<ul>
<li class="chapter" data-level="20.2.1" data-path="lotka-volterra-competition.html"><a href="lotka-volterra-competition.html#the-questions"><i class="fa fa-check"></i><b>20.2.1</b> The questions</a></li>
</ul></li>
<li class="chapter" data-level="20.3" data-path="lotka-volterra-competition.html"><a href="lotka-volterra-competition.html#takeaways-17"><i class="fa fa-check"></i><b>20.3</b> Takeaways</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="lotka-volterra-predator-prey-dynamics.html"><a href="lotka-volterra-predator-prey-dynamics.html"><i class="fa fa-check"></i><b>21</b> Lotka-Volterra predator-prey dynamics</a>
<ul>
<li class="chapter" data-level="21.1" data-path="lotka-volterra-predator-prey-dynamics.html"><a href="lotka-volterra-predator-prey-dynamics.html#background-16"><i class="fa fa-check"></i><b>21.1</b> Background</a></li>
<li class="chapter" data-level="21.2" data-path="lotka-volterra-predator-prey-dynamics.html"><a href="lotka-volterra-predator-prey-dynamics.html#worked-example-16"><i class="fa fa-check"></i><b>21.2</b> Worked example</a></li>
<li class="chapter" data-level="21.3" data-path="lotka-volterra-predator-prey-dynamics.html"><a href="lotka-volterra-predator-prey-dynamics.html#your-task-17"><i class="fa fa-check"></i><b>21.3</b> Your task</a></li>
<li class="chapter" data-level="21.4" data-path="lotka-volterra-predator-prey-dynamics.html"><a href="lotka-volterra-predator-prey-dynamics.html#optional-extras"><i class="fa fa-check"></i><b>21.4</b> Optional extras</a></li>
<li class="chapter" data-level="21.5" data-path="lotka-volterra-predator-prey-dynamics.html"><a href="lotka-volterra-predator-prey-dynamics.html#r-version"><i class="fa fa-check"></i><b>21.5</b> R-version</a>
<ul>
<li class="chapter" data-level="21.5.1" data-path="lotka-volterra-predator-prey-dynamics.html"><a href="lotka-volterra-predator-prey-dynamics.html#reference"><i class="fa fa-check"></i><b>21.5.1</b> Reference</a></li>
</ul></li>
<li class="chapter" data-level="21.6" data-path="lotka-volterra-predator-prey-dynamics.html"><a href="lotka-volterra-predator-prey-dynamics.html#takeaways-18"><i class="fa fa-check"></i><b>21.6</b> Takeaways</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="continuous-time-lotka-volterra-predator-prey-model-in-r.html"><a href="continuous-time-lotka-volterra-predator-prey-model-in-r.html"><i class="fa fa-check"></i><b>22</b> Continuous-time Lotka-Volterra Predator-Prey Model in R</a>
<ul>
<li class="chapter" data-level="22.1" data-path="continuous-time-lotka-volterra-predator-prey-model-in-r.html"><a href="continuous-time-lotka-volterra-predator-prey-model-in-r.html#background-17"><i class="fa fa-check"></i><b>22.1</b> Background</a></li>
<li class="chapter" data-level="22.2" data-path="continuous-time-lotka-volterra-predator-prey-model-in-r.html"><a href="continuous-time-lotka-volterra-predator-prey-model-in-r.html#worked-example-17"><i class="fa fa-check"></i><b>22.2</b> Worked example</a></li>
<li class="chapter" data-level="22.3" data-path="continuous-time-lotka-volterra-predator-prey-model-in-r.html"><a href="continuous-time-lotka-volterra-predator-prey-model-in-r.html#your-task-18"><i class="fa fa-check"></i><b>22.3</b> Your task</a>
<ul>
<li class="chapter" data-level="22.3.1" data-path="continuous-time-lotka-volterra-predator-prey-model-in-r.html"><a href="continuous-time-lotka-volterra-predator-prey-model-in-r.html#step-0-create-a-new-script"><i class="fa fa-check"></i><b>22.3.1</b> Step 0: Create a new script</a></li>
<li class="chapter" data-level="22.3.2" data-path="continuous-time-lotka-volterra-predator-prey-model-in-r.html"><a href="continuous-time-lotka-volterra-predator-prey-model-in-r.html#step-1-load-necessary-libraries"><i class="fa fa-check"></i><b>22.3.2</b> Step 1: Load Necessary Libraries</a></li>
<li class="chapter" data-level="22.3.3" data-path="continuous-time-lotka-volterra-predator-prey-model-in-r.html"><a href="continuous-time-lotka-volterra-predator-prey-model-in-r.html#step-2-define-the-model"><i class="fa fa-check"></i><b>22.3.3</b> Step 2: Define the Model</a></li>
<li class="chapter" data-level="22.3.4" data-path="continuous-time-lotka-volterra-predator-prey-model-in-r.html"><a href="continuous-time-lotka-volterra-predator-prey-model-in-r.html#step-3-set-parameters-and-initial-conditions"><i class="fa fa-check"></i><b>22.3.4</b> Step 3: Set Parameters and Initial Conditions</a></li>
<li class="chapter" data-level="22.3.5" data-path="continuous-time-lotka-volterra-predator-prey-model-in-r.html"><a href="continuous-time-lotka-volterra-predator-prey-model-in-r.html#step-4-simulate-the-model"><i class="fa fa-check"></i><b>22.3.5</b> Step 4: Simulate the Model</a></li>
<li class="chapter" data-level="22.3.6" data-path="continuous-time-lotka-volterra-predator-prey-model-in-r.html"><a href="continuous-time-lotka-volterra-predator-prey-model-in-r.html#step-5-visualise-the-dynamics"><i class="fa fa-check"></i><b>22.3.6</b> Step 5: Visualise the Dynamics</a></li>
<li class="chapter" data-level="22.3.7" data-path="continuous-time-lotka-volterra-predator-prey-model-in-r.html"><a href="continuous-time-lotka-volterra-predator-prey-model-in-r.html#questions-11"><i class="fa fa-check"></i><b>22.3.7</b> Questions</a></li>
<li class="chapter" data-level="22.3.8" data-path="continuous-time-lotka-volterra-predator-prey-model-in-r.html"><a href="continuous-time-lotka-volterra-predator-prey-model-in-r.html#conclusion"><i class="fa fa-check"></i><b>22.3.8</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="22.4" data-path="continuous-time-lotka-volterra-predator-prey-model-in-r.html"><a href="continuous-time-lotka-volterra-predator-prey-model-in-r.html#takeaways-19"><i class="fa fa-check"></i><b>22.4</b> Takeaways</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="discrete-time-lotka-volterra-predator-prey-model-in-r.html"><a href="discrete-time-lotka-volterra-predator-prey-model-in-r.html"><i class="fa fa-check"></i><b>23</b> Discrete-time Lotka-Volterra Predator-Prey Model in R</a>
<ul>
<li class="chapter" data-level="23.1" data-path="discrete-time-lotka-volterra-predator-prey-model-in-r.html"><a href="discrete-time-lotka-volterra-predator-prey-model-in-r.html#learning-outcomes-4"><i class="fa fa-check"></i><b>23.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="23.2" data-path="discrete-time-lotka-volterra-predator-prey-model-in-r.html"><a href="discrete-time-lotka-volterra-predator-prey-model-in-r.html#worked-example-18"><i class="fa fa-check"></i><b>23.2</b> Worked example</a></li>
<li class="chapter" data-level="23.3" data-path="discrete-time-lotka-volterra-predator-prey-model-in-r.html"><a href="discrete-time-lotka-volterra-predator-prey-model-in-r.html#introduction-1"><i class="fa fa-check"></i><b>23.3</b> Introduction</a></li>
<li class="chapter" data-level="23.4" data-path="discrete-time-lotka-volterra-predator-prey-model-in-r.html"><a href="discrete-time-lotka-volterra-predator-prey-model-in-r.html#step-1-define-the-model"><i class="fa fa-check"></i><b>23.4</b> Step 1: Define the Model</a></li>
<li class="chapter" data-level="23.5" data-path="discrete-time-lotka-volterra-predator-prey-model-in-r.html"><a href="discrete-time-lotka-volterra-predator-prey-model-in-r.html#step-2-set-parameters-and-initial-conditions"><i class="fa fa-check"></i><b>23.5</b> Step 2: Set Parameters and Initial Conditions</a></li>
<li class="chapter" data-level="23.6" data-path="discrete-time-lotka-volterra-predator-prey-model-in-r.html"><a href="discrete-time-lotka-volterra-predator-prey-model-in-r.html#step-3-simulate-the-model"><i class="fa fa-check"></i><b>23.6</b> Step 3: Simulate the Model</a></li>
<li class="chapter" data-level="23.7" data-path="discrete-time-lotka-volterra-predator-prey-model-in-r.html"><a href="discrete-time-lotka-volterra-predator-prey-model-in-r.html#step-4-visualise-the-dynamics"><i class="fa fa-check"></i><b>23.7</b> Step 4: Visualise the Dynamics</a>
<ul>
<li class="chapter" data-level="23.7.1" data-path="discrete-time-lotka-volterra-predator-prey-model-in-r.html"><a href="discrete-time-lotka-volterra-predator-prey-model-in-r.html#population-dynamics-over-time-1"><i class="fa fa-check"></i><b>23.7.1</b> Population Dynamics Over Time</a></li>
<li class="chapter" data-level="23.7.2" data-path="discrete-time-lotka-volterra-predator-prey-model-in-r.html"><a href="discrete-time-lotka-volterra-predator-prey-model-in-r.html#phase-plot-with-zngis-1"><i class="fa fa-check"></i><b>23.7.2</b> Phase Plot with ZNGIs</a></li>
</ul></li>
<li class="chapter" data-level="23.8" data-path="discrete-time-lotka-volterra-predator-prey-model-in-r.html"><a href="discrete-time-lotka-volterra-predator-prey-model-in-r.html#conclusion-1"><i class="fa fa-check"></i><b>23.8</b> Conclusion</a></li>
<li class="chapter" data-level="23.9" data-path="discrete-time-lotka-volterra-predator-prey-model-in-r.html"><a href="discrete-time-lotka-volterra-predator-prey-model-in-r.html#your-task-19"><i class="fa fa-check"></i><b>23.9</b> Your task</a></li>
<li class="chapter" data-level="23.10" data-path="discrete-time-lotka-volterra-predator-prey-model-in-r.html"><a href="discrete-time-lotka-volterra-predator-prey-model-in-r.html#takeaways-20"><i class="fa fa-check"></i><b>23.10</b> Takeaways</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-5.html"><a href="part-5.html"><i class="fa fa-check"></i>Part 5: Animal behaviour, altruism and sexual selection</a></li>
<li class="chapter" data-level="24" data-path="game-theory-hawks-and-doves.html"><a href="game-theory-hawks-and-doves.html"><i class="fa fa-check"></i><b>24</b> Game theory: Hawks and doves</a>
<ul>
<li class="chapter" data-level="24.1" data-path="game-theory-hawks-and-doves.html"><a href="game-theory-hawks-and-doves.html#background-18"><i class="fa fa-check"></i><b>24.1</b> Background</a></li>
<li class="chapter" data-level="24.2" data-path="game-theory-hawks-and-doves.html"><a href="game-theory-hawks-and-doves.html#worked-example-19"><i class="fa fa-check"></i><b>24.2</b> Worked example</a></li>
<li class="chapter" data-level="24.3" data-path="game-theory-hawks-and-doves.html"><a href="game-theory-hawks-and-doves.html#your-task-20"><i class="fa fa-check"></i><b>24.3</b> Your task</a></li>
<li class="chapter" data-level="24.4" data-path="game-theory-hawks-and-doves.html"><a href="game-theory-hawks-and-doves.html#the-payoff-table"><i class="fa fa-check"></i><b>24.4</b> The payoff table</a>
<ul>
<li class="chapter" data-level="24.4.1" data-path="game-theory-hawks-and-doves.html"><a href="game-theory-hawks-and-doves.html#hypotheses"><i class="fa fa-check"></i><b>24.4.1</b> Hypotheses</a></li>
<li class="chapter" data-level="24.4.2" data-path="game-theory-hawks-and-doves.html"><a href="game-theory-hawks-and-doves.html#game-one"><i class="fa fa-check"></i><b>24.4.2</b> GAME ONE</a></li>
<li class="chapter" data-level="24.4.3" data-path="game-theory-hawks-and-doves.html"><a href="game-theory-hawks-and-doves.html#game-two"><i class="fa fa-check"></i><b>24.4.3</b> GAME TWO</a></li>
</ul></li>
<li class="chapter" data-level="24.5" data-path="game-theory-hawks-and-doves.html"><a href="game-theory-hawks-and-doves.html#summarise-results"><i class="fa fa-check"></i><b>24.5</b> SUMMARISE RESULTS</a></li>
<li class="chapter" data-level="24.6" data-path="game-theory-hawks-and-doves.html"><a href="game-theory-hawks-and-doves.html#acknowledgement"><i class="fa fa-check"></i><b>24.6</b> Acknowledgement</a></li>
<li class="chapter" data-level="24.7" data-path="game-theory-hawks-and-doves.html"><a href="game-theory-hawks-and-doves.html#takeaways-21"><i class="fa fa-check"></i><b>24.7</b> Takeaways</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-6.html"><a href="part-6.html"><i class="fa fa-check"></i>Part 6: Solutions/answers</a></li>
<li class="chapter" data-level="25" data-path="solutions-and-take-home-messages.html"><a href="solutions-and-take-home-messages.html"><i class="fa fa-check"></i><b>25</b> Solutions and “take-home” messages</a>
<ul>
<li class="chapter" data-level="25.1" data-path="solutions-and-take-home-messages.html"><a href="solutions-and-take-home-messages.html#how-to-use-this-section"><i class="fa fa-check"></i><b>25.1</b> How to use this section</a></li>
<li class="chapter" data-level="25.2" data-path="solutions-and-take-home-messages.html"><a href="solutions-and-take-home-messages.html#solutions-the-blind-watchmaker"><i class="fa fa-check"></i><b>25.2</b> Solutions: The blind watchmaker</a></li>
<li class="chapter" data-level="25.3" data-path="solutions-and-take-home-messages.html"><a href="solutions-and-take-home-messages.html#solutions-bug-hunt-camouflage"><i class="fa fa-check"></i><b>25.3</b> Solutions: Bug hunt camouflage</a></li>
<li class="chapter" data-level="25.4" data-path="solutions-and-take-home-messages.html"><a href="solutions-and-take-home-messages.html#solutions-geometric-growth"><i class="fa fa-check"></i><b>25.4</b> Solutions: Geometric growth</a></li>
<li class="chapter" data-level="25.5" data-path="solutions-and-take-home-messages.html"><a href="solutions-and-take-home-messages.html#solutions-estimating-population-growth-rate"><i class="fa fa-check"></i><b>25.5</b> Solutions: Estimating Population Growth Rate</a></li>
<li class="chapter" data-level="25.6" data-path="solutions-and-take-home-messages.html"><a href="solutions-and-take-home-messages.html#solutions-stochastic-population-growth"><i class="fa fa-check"></i><b>25.6</b> Solutions: Stochastic population growth</a></li>
<li class="chapter" data-level="25.7" data-path="solutions-and-take-home-messages.html"><a href="solutions-and-take-home-messages.html#solutions-basic-logistic-population-growth"><i class="fa fa-check"></i><b>25.7</b> Solutions: Basic logistic population growth</a></li>
<li class="chapter" data-level="25.8" data-path="solutions-and-take-home-messages.html"><a href="solutions-and-take-home-messages.html#solutions-deeper-into-logistic-growth"><i class="fa fa-check"></i><b>25.8</b> Solutions: Deeper into logistic growth</a>
<ul>
<li class="chapter" data-level="25.8.1" data-path="solutions-and-take-home-messages.html"><a href="solutions-and-take-home-messages.html#relationship-between-logistic-and-exponential-growth-equations"><i class="fa fa-check"></i><b>25.8.1</b> Relationship between Logistic and Exponential growth equations</a></li>
<li class="chapter" data-level="25.8.2" data-path="solutions-and-take-home-messages.html"><a href="solutions-and-take-home-messages.html#type-of-dynamics-depends-on-r_m."><i class="fa fa-check"></i><b>25.8.2</b> Type of dynamics depends on <span class="math inline">\(r_m\)</span>.</a></li>
<li class="chapter" data-level="25.8.3" data-path="solutions-and-take-home-messages.html"><a href="solutions-and-take-home-messages.html#you-can-obtain-parameters-from-graphs"><i class="fa fa-check"></i><b>25.8.3</b> You can obtain parameters from graphs</a></li>
<li class="chapter" data-level="25.8.4" data-path="solutions-and-take-home-messages.html"><a href="solutions-and-take-home-messages.html#time-lag"><i class="fa fa-check"></i><b>25.8.4</b> Time lag</a></li>
<li class="chapter" data-level="25.8.5" data-path="solutions-and-take-home-messages.html"><a href="solutions-and-take-home-messages.html#chaotic-dynamics"><i class="fa fa-check"></i><b>25.8.5</b> Chaotic dynamics</a></li>
</ul></li>
<li class="chapter" data-level="25.9" data-path="solutions-and-take-home-messages.html"><a href="solutions-and-take-home-messages.html#solutions-life-tables-and-survivorship-types"><i class="fa fa-check"></i><b>25.9</b> Solutions: Life tables and survivorship types</a></li>
<li class="chapter" data-level="25.10" data-path="solutions-and-take-home-messages.html"><a href="solutions-and-take-home-messages.html#solutions-matrix-population-modelling"><i class="fa fa-check"></i><b>25.10</b> Solutions: Matrix population modelling</a></li>
<li class="chapter" data-level="25.11" data-path="solutions-and-take-home-messages.html"><a href="solutions-and-take-home-messages.html#solutions-how-many-eggs-should-a-bird-lay"><i class="fa fa-check"></i><b>25.11</b> Solutions: How many eggs should a bird lay?</a></li>
<li class="chapter" data-level="25.12" data-path="solutions-and-take-home-messages.html"><a href="solutions-and-take-home-messages.html#solutions-trade-offs-and-the-force-of-selection"><i class="fa fa-check"></i><b>25.12</b> Solutions: Trade-offs and the force of selection</a></li>
<li class="chapter" data-level="25.13" data-path="solutions-and-take-home-messages.html"><a href="solutions-and-take-home-messages.html#solutions-hardy-weinberg-equilibrium"><i class="fa fa-check"></i><b>25.13</b> Solutions: Hardy-Weinberg equilibrium</a>
<ul>
<li class="chapter" data-level="25.13.1" data-path="solutions-and-take-home-messages.html"><a href="solutions-and-take-home-messages.html#problem-1"><i class="fa fa-check"></i><b>25.13.1</b> Problem 1</a></li>
<li class="chapter" data-level="25.13.2" data-path="solutions-and-take-home-messages.html"><a href="solutions-and-take-home-messages.html#problem-2"><i class="fa fa-check"></i><b>25.13.2</b> Problem 2</a></li>
<li class="chapter" data-level="25.13.3" data-path="solutions-and-take-home-messages.html"><a href="solutions-and-take-home-messages.html#problem-3"><i class="fa fa-check"></i><b>25.13.3</b> Problem 3</a></li>
<li class="chapter" data-level="25.13.4" data-path="solutions-and-take-home-messages.html"><a href="solutions-and-take-home-messages.html#problem-4"><i class="fa fa-check"></i><b>25.13.4</b> Problem 4</a></li>
</ul></li>
<li class="chapter" data-level="25.14" data-path="solutions-and-take-home-messages.html"><a href="solutions-and-take-home-messages.html#solutions-gene-pool-model"><i class="fa fa-check"></i><b>25.14</b> Solutions: Gene pool model</a>
<ul>
<li class="chapter" data-level="25.14.1" data-path="solutions-and-take-home-messages.html"><a href="solutions-and-take-home-messages.html#discussion-questions"><i class="fa fa-check"></i><b>25.14.1</b> Discussion questions</a></li>
<li class="chapter" data-level="25.14.2" data-path="solutions-and-take-home-messages.html"><a href="solutions-and-take-home-messages.html#bottlenecks-1"><i class="fa fa-check"></i><b>25.14.2</b> Bottlenecks</a></li>
<li class="chapter" data-level="25.14.3" data-path="solutions-and-take-home-messages.html"><a href="solutions-and-take-home-messages.html#broader-questions"><i class="fa fa-check"></i><b>25.14.3</b> Broader questions</a></li>
</ul></li>
<li class="chapter" data-level="25.15" data-path="solutions-and-take-home-messages.html"><a href="solutions-and-take-home-messages.html#solutions-neutral-or-adaptive-evolution-in-humans"><i class="fa fa-check"></i><b>25.15</b> Solutions: Neutral or adaptive evolution in humans</a></li>
<li class="chapter" data-level="25.16" data-path="solutions-and-take-home-messages.html"><a href="solutions-and-take-home-messages.html#solutions-heritability"><i class="fa fa-check"></i><b>25.16</b> Solutions: Heritability</a></li>
<li class="chapter" data-level="25.17" data-path="solutions-and-take-home-messages.html"><a href="solutions-and-take-home-messages.html#solutions-lotka-volterra-competition"><i class="fa fa-check"></i><b>25.17</b> Solutions: Lotka-Volterra competition</a></li>
<li class="chapter" data-level="25.18" data-path="solutions-and-take-home-messages.html"><a href="solutions-and-take-home-messages.html#solutions-lotka-volterra-predator-prey-dynamics"><i class="fa fa-check"></i><b>25.18</b> Solutions: Lotka-Volterra predator-prey dynamics</a></li>
<li class="chapter" data-level="25.19" data-path="solutions-and-take-home-messages.html"><a href="solutions-and-take-home-messages.html#solutions-the-legend-of-ambalappuzha"><i class="fa fa-check"></i><b>25.19</b> Solutions: The legend of Ambalappuzha</a></li>
<li class="chapter" data-level="25.20" data-path="solutions-and-take-home-messages.html"><a href="solutions-and-take-home-messages.html#solutions-from-population-biology-to-fitness"><i class="fa fa-check"></i><b>25.20</b> Solutions: From population biology to fitness</a></li>
</ul></li>
<li class="chapter" data-level="26" data-path="results-of-the-hawk-dove-games.html"><a href="results-of-the-hawk-dove-games.html"><i class="fa fa-check"></i><b>26</b> Results of the hawk-dove games</a>
<ul>
<li class="chapter" data-level="26.0.1" data-path="results-of-the-hawk-dove-games.html"><a href="results-of-the-hawk-dove-games.html#game-2---different-opponents"><i class="fa fa-check"></i><b>26.0.1</b> Game 2 - different opponents</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-7.html"><a href="part-7.html"><i class="fa fa-check"></i>Part 7: Appendix - extras</a></li>
<li class="chapter" data-level="27" data-path="exponential-growth-in-detail.html"><a href="exponential-growth-in-detail.html"><i class="fa fa-check"></i><b>27</b> Exponential growth in detail</a>
<ul>
<li class="chapter" data-level="27.0.1" data-path="exponential-growth-in-detail.html"><a href="exponential-growth-in-detail.html#nomenclature"><i class="fa fa-check"></i><b>27.0.1</b> Nomenclature</a></li>
<li class="chapter" data-level="27.1" data-path="exponential-growth-in-detail.html"><a href="exponential-growth-in-detail.html#discrete-time-model"><i class="fa fa-check"></i><b>27.1</b> Discrete time model</a>
<ul>
<li class="chapter" data-level="27.1.1" data-path="exponential-growth-in-detail.html"><a href="exponential-growth-in-detail.html#calculating-n-for-any-future-time-point"><i class="fa fa-check"></i><b>27.1.1</b> Calculating N for any future time point</a></li>
<li class="chapter" data-level="27.1.2" data-path="exponential-growth-in-detail.html"><a href="exponential-growth-in-detail.html#applying-the-model"><i class="fa fa-check"></i><b>27.1.2</b> Applying the model</a></li>
</ul></li>
<li class="chapter" data-level="27.2" data-path="exponential-growth-in-detail.html"><a href="exponential-growth-in-detail.html#real-world-application-breeding-pairs-of-merlin-falco-columbarius"><i class="fa fa-check"></i><b>27.2</b> Real-World Application: Breeding Pairs of Merlin (Falco columbarius)</a>
<ul>
<li class="chapter" data-level="27.2.1" data-path="exponential-growth-in-detail.html"><a href="exponential-growth-in-detail.html#observations-and-context"><i class="fa fa-check"></i><b>27.2.1</b> Observations and Context</a></li>
<li class="chapter" data-level="27.2.2" data-path="exponential-growth-in-detail.html"><a href="exponential-growth-in-detail.html#applying-the-exponential-growth-model"><i class="fa fa-check"></i><b>27.2.2</b> Applying the Exponential Growth Model</a></li>
</ul></li>
<li class="chapter" data-level="27.3" data-path="exponential-growth-in-detail.html"><a href="exponential-growth-in-detail.html#continuous-time-model"><i class="fa fa-check"></i><b>27.3</b> Continuous time model</a>
<ul>
<li class="chapter" data-level="27.3.1" data-path="exponential-growth-in-detail.html"><a href="exponential-growth-in-detail.html#zero-population-growth"><i class="fa fa-check"></i><b>27.3.1</b> Zero population growth</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="28" data-path="the-legend-of-ambalappuzha.html"><a href="the-legend-of-ambalappuzha.html"><i class="fa fa-check"></i><b>28</b> The legend of Ambalappuzha</a>
<ul>
<li class="chapter" data-level="28.1" data-path="the-legend-of-ambalappuzha.html"><a href="the-legend-of-ambalappuzha.html#animalsplants-not-grains-of-rice"><i class="fa fa-check"></i><b>28.1</b> Animals/plants, not grains of rice</a>
<ul>
<li class="chapter" data-level="28.1.1" data-path="the-legend-of-ambalappuzha.html"><a href="the-legend-of-ambalappuzha.html#quick-exercise-optional"><i class="fa fa-check"></i><b>28.1.1</b> Quick exercise (optional)</a></li>
<li class="chapter" data-level="28.1.2" data-path="the-legend-of-ambalappuzha.html"><a href="the-legend-of-ambalappuzha.html#discussion-prompts"><i class="fa fa-check"></i><b>28.1.2</b> Discussion prompts</a></li>
</ul></li>
<li class="chapter" data-level="28.2" data-path="the-legend-of-ambalappuzha.html"><a href="the-legend-of-ambalappuzha.html#optional-try-these-calculations-in-r"><i class="fa fa-check"></i><b>28.2</b> Optional: Try these calculations in R</a></li>
</ul></li>
<li class="chapter" data-level="29" data-path="from-population-biology-to-fitness.html"><a href="from-population-biology-to-fitness.html"><i class="fa fa-check"></i><b>29</b> From population biology to fitness</a>
<ul>
<li class="chapter" data-level="29.1" data-path="from-population-biology-to-fitness.html"><a href="from-population-biology-to-fitness.html#an-in-silico-experiment"><i class="fa fa-check"></i><b>29.1</b> An <em>in silico</em> experiment</a></li>
<li class="chapter" data-level="29.2" data-path="from-population-biology-to-fitness.html"><a href="from-population-biology-to-fitness.html#the-link-to-fitness"><i class="fa fa-check"></i><b>29.2</b> The link to fitness</a></li>
<li class="chapter" data-level="29.3" data-path="from-population-biology-to-fitness.html"><a href="from-population-biology-to-fitness.html#introducing-a-trade-off"><i class="fa fa-check"></i><b>29.3</b> Introducing a trade-off</a></li>
</ul></li>
<li class="chapter" data-level="30" data-path="from-plain-english-to-a-matrix-model.html"><a href="from-plain-english-to-a-matrix-model.html"><i class="fa fa-check"></i><b>30</b> From plain English to a matrix model</a>
<ul>
<li class="chapter" data-level="30.1" data-path="from-plain-english-to-a-matrix-model.html"><a href="from-plain-english-to-a-matrix-model.html#background-19"><i class="fa fa-check"></i><b>30.1</b> Background</a></li>
<li class="chapter" data-level="30.2" data-path="from-plain-english-to-a-matrix-model.html"><a href="from-plain-english-to-a-matrix-model.html#worked-example-20"><i class="fa fa-check"></i><b>30.2</b> Worked example</a></li>
<li class="chapter" data-level="30.3" data-path="from-plain-english-to-a-matrix-model.html"><a href="from-plain-english-to-a-matrix-model.html#your-task-21"><i class="fa fa-check"></i><b>30.3</b> Your task</a></li>
<li class="chapter" data-level="30.4" data-path="from-plain-english-to-a-matrix-model.html"><a href="from-plain-english-to-a-matrix-model.html#takeaways-22"><i class="fa fa-check"></i><b>30.4</b> Takeaways</a></li>
</ul></li>
<li class="chapter" data-level="31" data-path="continuous-traits-from-discrete-genes.html"><a href="continuous-traits-from-discrete-genes.html"><i class="fa fa-check"></i><b>31</b> Continuous traits from discrete genes</a>
<ul>
<li class="chapter" data-level="31.1" data-path="continuous-traits-from-discrete-genes.html"><a href="continuous-traits-from-discrete-genes.html#background-20"><i class="fa fa-check"></i><b>31.1</b> Background</a></li>
<li class="chapter" data-level="31.2" data-path="continuous-traits-from-discrete-genes.html"><a href="continuous-traits-from-discrete-genes.html#worked-example-21"><i class="fa fa-check"></i><b>31.2</b> Worked example</a></li>
<li class="chapter" data-level="31.3" data-path="continuous-traits-from-discrete-genes.html"><a href="continuous-traits-from-discrete-genes.html#your-task-22"><i class="fa fa-check"></i><b>31.3</b> Your task</a></li>
<li class="chapter" data-level="31.4" data-path="continuous-traits-from-discrete-genes.html"><a href="continuous-traits-from-discrete-genes.html#takeaways-23"><i class="fa fa-check"></i><b>31.4</b> Takeaways</a></li>
</ul></li>
<li class="chapter" data-level="32" data-path="building-a-phylogenetic-tree.html"><a href="building-a-phylogenetic-tree.html"><i class="fa fa-check"></i><b>32</b> Building a phylogenetic tree</a>
<ul>
<li class="chapter" data-level="32.1" data-path="building-a-phylogenetic-tree.html"><a href="building-a-phylogenetic-tree.html#background-21"><i class="fa fa-check"></i><b>32.1</b> Background</a></li>
<li class="chapter" data-level="32.2" data-path="building-a-phylogenetic-tree.html"><a href="building-a-phylogenetic-tree.html#worked-example-22"><i class="fa fa-check"></i><b>32.2</b> Worked example</a></li>
<li class="chapter" data-level="32.3" data-path="building-a-phylogenetic-tree.html"><a href="building-a-phylogenetic-tree.html#your-task-23"><i class="fa fa-check"></i><b>32.3</b> Your task</a></li>
<li class="chapter" data-level="32.4" data-path="building-a-phylogenetic-tree.html"><a href="building-a-phylogenetic-tree.html#takeaways-24"><i class="fa fa-check"></i><b>32.4</b> Takeaways</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">BB512 - Population Biology and Evolution</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="matrix-population-models-mpms-projection-and-simulation" class="section level1 hasAnchor" number="15">
<h1><span class="header-section-number">15</span> Matrix Population Models (MPMs): Projection and Simulation<a href="matrix-population-models-mpms-projection-and-simulation.html#matrix-population-models-mpms-projection-and-simulation" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This short tutorial introduces <strong>matrix population models (MPMs)</strong> and shows two closely related uses:</p>
<ol style="list-style-type: decimal">
<li><strong>Projection</strong>: how a population vector is projected forward through time using a matrix.</li>
<li><strong>Simulation</strong>: how the same structure can be used to explore scenarios (e.g. <strong>culling</strong>) and quantify uncertainty.</li>
</ol>
<p>The examples use a simple 3-stage life cycle. The goal is to be clear about:</p>
<ul>
<li>the <strong>projection interval</strong> (time step, \(\Delta t\)),</li>
<li>how <strong>survival/transition</strong> and <strong>reproduction</strong> appear in the matrix,</li>
<li>how to project a <strong>population vector</strong> \(\mathbf{n}_t\),</li>
<li>how to convert the deterministic model into a basic <strong>stochastic simulation</strong>.</li>
</ul>
<div id="what-is-a-matrix-population-model" class="section level2 hasAnchor" number="15.1">
<h2><span class="header-section-number">15.1</span> What is a matrix population model?<a href="matrix-population-models-mpms-projection-and-simulation.html#what-is-a-matrix-population-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>An MPM describes how a structured population changes over discrete time steps.</p>
</div>
<div id="the-projection-interval-delta-t" class="section level2 hasAnchor" number="15.2">
<h2><span class="header-section-number">15.2</span> The projection interval (\(\Delta t\))<a href="matrix-population-models-mpms-projection-and-simulation.html#the-projection-interval-delta-t" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>MPMs are defined for a particular <strong>projection interval</strong> \(\Delta t\) (the time step between updates). Common choices are:</p>
<ul>
<li>\(\Delta t = 1\) year (very common in ecology)</li>
<li>\(\Delta t = 1\) month (or other shorter steps)</li>
</ul>
<p><strong>Key rule:</strong> the vital rates you put in the matrix must match the chosen \(\Delta t\).</p>
<ul>
<li>If \(\Delta t\) is one year, use <strong>annual survival</strong> and <strong>annual fertility/recruitment</strong>.</li>
<li>If \(\Delta t\) is one month, use <strong>monthly survival</strong> and <strong>monthly recruitment</strong>.</li>
</ul>
<p>A common mistake is mixing time scales (e.g. monthly survival with yearly reproduction).</p>
</div>
<div id="the-population-vector" class="section level2 hasAnchor" number="15.3">
<h2><span class="header-section-number">15.3</span> The population vector<a href="matrix-population-models-mpms-projection-and-simulation.html#the-population-vector" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Let \(\mathbf{n}_t\) be a vector of abundances at time \(t\) (measured in units of \(\Delta t\)):</p>
<p><span class="math display">\[
\mathbf{n}_t =
\begin{bmatrix}
n_{1,t} \\
n_{2,t} \\
\vdots \\
n_{k,t}
\end{bmatrix}
\]</span></p>
<p>Each element is the number (or density) in a class (age/stage/size/etc.).</p>
</div>
<div id="the-projection-matrix" class="section level2 hasAnchor" number="15.4">
<h2><span class="header-section-number">15.4</span> The projection matrix<a href="matrix-population-models-mpms-projection-and-simulation.html#the-projection-matrix" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Let \(\mathbf{A}\) be a square matrix of <strong>vital rates</strong>. The basic model is:</p>
<p><span class="math display">\[
\mathbf{n}_{t+\Delta t} = \mathbf{A}\,\mathbf{n}_t
\]</span></p>
<p>Interpretation of entries:</p>
<ul>
<li><strong>Survival / transition</strong>: individuals moving between classes (including remaining in the same class)</li>
<li><strong>Reproduction</strong>: production of new individuals (often into the first class)</li>
</ul>
</div>
<div id="a-simple-3-stage-model" class="section level2 hasAnchor" number="15.5">
<h2><span class="header-section-number">15.5</span> A simple 3-stage model<a href="matrix-population-models-mpms-projection-and-simulation.html#a-simple-3-stage-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We will use three stages:</p>
<ol style="list-style-type: decimal">
<li>Juvenile (J)</li>
<li>Subadult (S)</li>
<li>Adult (A)</li>
</ol>
<p>The life-cycle assumptions (per \(\Delta t = 1\) year) are:</p>
<ul>
<li>Adults produce juveniles: \(F_A\) juveniles per adult per year (recruits to J).</li>
<li>Juveniles that survive and grow move to Subadult with probability \(G_J\).</li>
<li>Subadults either:
<ul>
<li>survive and remain subadult with probability \(P_S\), or</li>
<li>survive and grow to adult with probability \(G_S\).</li>
</ul></li>
<li>Adults survive and remain adult with probability \(P_A\).</li>
</ul>
<p>A common stage-structured (Lefkovitch) matrix is:</p>
<p><span class="math display">\[
\mathbf{A} =
\begin{bmatrix}
0 &amp; 0 &amp; F_A \\
G_J &amp; P_S &amp; 0 \\
0 &amp; G_S &amp; P_A
\end{bmatrix}
\]</span></p>
</div>
<div id="projection-projecting-mathbfn_t-forward" class="section level2 hasAnchor" number="15.6">
<h2><span class="header-section-number">15.6</span> Projection: projecting \(\mathbf{n}_t\) forward<a href="matrix-population-models-mpms-projection-and-simulation.html#projection-projecting-mathbfn_t-forward" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="define-vital-rates-and-build-mathbfa" class="section level2 hasAnchor" number="15.7">
<h2><span class="header-section-number">15.7</span> Define vital rates and build \(\mathbf{A}\)<a href="matrix-population-models-mpms-projection-and-simulation.html#define-vital-rates-and-build-mathbfa" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb46-1" tabindex="-1"></a><span class="co"># Vital rates for a 1-year projection interval</span></span>
<span id="cb46-2"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb46-2" tabindex="-1"></a>F_A <span class="ot">&lt;-</span> <span class="fl">1.2</span>   <span class="co"># recruits (juveniles) per adult per year</span></span>
<span id="cb46-3"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb46-3" tabindex="-1"></a>G_J <span class="ot">&lt;-</span> <span class="fl">0.35</span>  <span class="co"># juvenile -&gt; subadult (survive + grow)</span></span>
<span id="cb46-4"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb46-4" tabindex="-1"></a>P_S <span class="ot">&lt;-</span> <span class="fl">0.55</span>  <span class="co"># subadult -&gt; subadult (survive + stay)</span></span>
<span id="cb46-5"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb46-5" tabindex="-1"></a>G_S <span class="ot">&lt;-</span> <span class="fl">0.25</span>  <span class="co"># subadult -&gt; adult (survive + grow)</span></span>
<span id="cb46-6"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb46-6" tabindex="-1"></a>P_A <span class="ot">&lt;-</span> <span class="fl">0.80</span>  <span class="co"># adult -&gt; adult (survive + stay)</span></span>
<span id="cb46-7"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb46-7" tabindex="-1"></a></span>
<span id="cb46-8"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb46-8" tabindex="-1"></a><span class="co"># Build the projection matrix (rows = stage at t+1, cols = stage at t)</span></span>
<span id="cb46-9"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb46-9" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(</span>
<span id="cb46-10"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb46-10" tabindex="-1"></a>  <span class="fu">c</span>(<span class="dv">0</span>,   <span class="dv">0</span>,   F_A,</span>
<span id="cb46-11"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb46-11" tabindex="-1"></a>    G_J, P_S, <span class="dv">0</span>,</span>
<span id="cb46-12"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb46-12" tabindex="-1"></a>    <span class="dv">0</span>,   G_S, P_A),</span>
<span id="cb46-13"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb46-13" tabindex="-1"></a>  <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span></span>
<span id="cb46-14"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb46-14" tabindex="-1"></a>)</span>
<span id="cb46-15"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb46-15" tabindex="-1"></a></span>
<span id="cb46-16"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb46-16" tabindex="-1"></a><span class="fu">dimnames</span>(A) <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb46-17"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb46-17" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">&quot;Juvenile&quot;</span>, <span class="st">&quot;Subadult&quot;</span>, <span class="st">&quot;Adult&quot;</span>),</span>
<span id="cb46-18"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb46-18" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">&quot;Juvenile&quot;</span>, <span class="st">&quot;Subadult&quot;</span>, <span class="st">&quot;Adult&quot;</span>)</span>
<span id="cb46-19"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb46-19" tabindex="-1"></a>)</span>
<span id="cb46-20"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb46-20" tabindex="-1"></a></span>
<span id="cb46-21"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb46-21" tabindex="-1"></a><span class="co"># Print matrix so we can check entries</span></span>
<span id="cb46-22"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb46-22" tabindex="-1"></a>A</span></code></pre></div>
<pre><code>##          Juvenile Subadult Adult
## Juvenile     0.00     0.00   1.2
## Subadult     0.35     0.55   0.0
## Adult        0.00     0.25   0.8</code></pre>
</div>
<div id="define-an-initial-population-vector-mathbfn_0" class="section level2 hasAnchor" number="15.8">
<h2><span class="header-section-number">15.8</span> Define an initial population vector \(\mathbf{n}_0\)<a href="matrix-population-models-mpms-projection-and-simulation.html#define-an-initial-population-vector-mathbfn_0" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb48-1" tabindex="-1"></a><span class="co"># Initial population vector (year 0)</span></span>
<span id="cb48-2"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb48-2" tabindex="-1"></a>n0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">Juvenile =</span> <span class="dv">50</span>, <span class="at">Subadult =</span> <span class="dv">30</span>, <span class="at">Adult =</span> <span class="dv">20</span>)</span>
<span id="cb48-3"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb48-3" tabindex="-1"></a>n0</span></code></pre></div>
<pre><code>## Juvenile Subadult    Adult 
##       50       30       20</code></pre>
</div>
<div id="one-step-projection" class="section level2 hasAnchor" number="15.9">
<h2><span class="header-section-number">15.9</span> One-step projection<a href="matrix-population-models-mpms-projection-and-simulation.html#one-step-projection" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb50-1" tabindex="-1"></a><span class="co"># Deterministic one-step update</span></span>
<span id="cb50-2"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb50-2" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> A <span class="sc">%*%</span> n0</span>
<span id="cb50-3"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb50-3" tabindex="-1"></a>n1</span></code></pre></div>
<pre><code>##          [,1]
## Juvenile 24.0
## Subadult 34.0
## Adult    23.5</code></pre>
<p>Given the stage abundances at time \(t\), multiplying by \(\mathbf{A}\) gives the expected abundances at time \(t+1\) (because \(\Delta t=1\) year here).</p>
</div>
<div id="project-for-many-years-deterministic" class="section level2 hasAnchor" number="15.10">
<h2><span class="header-section-number">15.10</span> Project for many years (deterministic)<a href="matrix-population-models-mpms-projection-and-simulation.html#project-for-many-years-deterministic" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb52-1" tabindex="-1"></a><span class="co"># Number of projection steps</span></span>
<span id="cb52-2"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb52-2" tabindex="-1"></a>years <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb52-3"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb52-3" tabindex="-1"></a></span>
<span id="cb52-4"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb52-4" tabindex="-1"></a><span class="co"># Matrix to store yearly stage abundances</span></span>
<span id="cb52-5"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb52-5" tabindex="-1"></a>nmat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA_real_</span>, <span class="at">nrow =</span> years <span class="sc">+</span> <span class="dv">1</span>, <span class="at">ncol =</span> <span class="fu">length</span>(n0))</span>
<span id="cb52-6"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb52-6" tabindex="-1"></a><span class="fu">colnames</span>(nmat) <span class="ot">&lt;-</span> <span class="fu">names</span>(n0)</span>
<span id="cb52-7"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb52-7" tabindex="-1"></a></span>
<span id="cb52-8"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb52-8" tabindex="-1"></a><span class="co"># Set initial year</span></span>
<span id="cb52-9"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb52-9" tabindex="-1"></a>nmat[<span class="dv">1</span>, ] <span class="ot">&lt;-</span> n0</span>
<span id="cb52-10"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb52-10" tabindex="-1"></a></span>
<span id="cb52-11"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb52-11" tabindex="-1"></a><span class="co"># Project forward one year at a time</span></span>
<span id="cb52-12"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb52-12" tabindex="-1"></a><span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>years) {</span>
<span id="cb52-13"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb52-13" tabindex="-1"></a>  nmat[t <span class="sc">+</span> <span class="dv">1</span>, ] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(A <span class="sc">%*%</span> nmat[t, ])</span>
<span id="cb52-14"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb52-14" tabindex="-1"></a>}</span>
<span id="cb52-15"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb52-15" tabindex="-1"></a></span>
<span id="cb52-16"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb52-16" tabindex="-1"></a><span class="fu">head</span>(nmat, <span class="dv">6</span>)</span></code></pre></div>
<pre><code>##      Juvenile Subadult    Adult
## [1,]  50.0000 30.00000 20.00000
## [2,]  24.0000 34.00000 23.50000
## [3,]  28.2000 27.10000 27.30000
## [4,]  32.7600 24.77500 28.61500
## [5,]  34.3380 25.09225 29.08575
## [6,]  34.9029 25.81904 29.54166</code></pre>
<div id="plot-totals-and-stage-trajectories" class="section level3 hasAnchor" number="15.10.1">
<h3><span class="header-section-number">15.10.1</span> Plot totals and stage trajectories<a href="matrix-population-models-mpms-projection-and-simulation.html#plot-totals-and-stage-trajectories" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb54-1" tabindex="-1"></a><span class="co"># Total abundance each year</span></span>
<span id="cb54-2"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb54-2" tabindex="-1"></a>totalN <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(nmat)</span>
<span id="cb54-3"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb54-3" tabindex="-1"></a></span>
<span id="cb54-4"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb54-4" tabindex="-1"></a><span class="co"># Plot total abundance</span></span>
<span id="cb54-5"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb54-5" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb54-6"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb54-6" tabindex="-1"></a>  <span class="dv">0</span><span class="sc">:</span>years, totalN, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>,</span>
<span id="cb54-7"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb54-7" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;Year&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Total population size&quot;</span></span>
<span id="cb54-8"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb54-8" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="BB512_files/figure-html/mpm_deterministic_plots-1.png" alt="" width="672" /></p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb55-1" tabindex="-1"></a><span class="co"># Plot stage-specific abundances</span></span>
<span id="cb55-2"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb55-2" tabindex="-1"></a><span class="fu">matplot</span>(</span>
<span id="cb55-3"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb55-3" tabindex="-1"></a>  <span class="dv">0</span><span class="sc">:</span>years, nmat, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">lty =</span> <span class="dv">1</span>,</span>
<span id="cb55-4"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb55-4" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;Year&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Abundance&quot;</span></span>
<span id="cb55-5"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb55-5" tabindex="-1"></a>)</span>
<span id="cb55-6"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb55-6" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="at">legend =</span> <span class="fu">colnames</span>(nmat), <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<p><img src="BB512_files/figure-html/mpm_deterministic_plots-2.png" alt="" width="672" /></p>
</div>
</div>
<div id="long-term-growth-rate-lambda" class="section level2 hasAnchor" number="15.11">
<h2><span class="header-section-number">15.11</span> Long-term growth rate (\(\lambda\))<a href="matrix-population-models-mpms-projection-and-simulation.html#long-term-growth-rate-lambda" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>For a constant matrix \(\mathbf{A}\), the asymptotic growth rate is the <strong>dominant eigenvalue</strong> \(\lambda\).</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb56-1" tabindex="-1"></a><span class="co"># Eigenvalues of the projection matrix</span></span>
<span id="cb56-2"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb56-2" tabindex="-1"></a>eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(A)</span>
<span id="cb56-3"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb56-3" tabindex="-1"></a></span>
<span id="cb56-4"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb56-4" tabindex="-1"></a><span class="co"># Dominant eigenvalue is asymptotic growth rate lambda</span></span>
<span id="cb56-5"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb56-5" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="fu">Re</span>(eig<span class="sc">$</span>values[<span class="fu">which.max</span>(<span class="fu">Re</span>(eig<span class="sc">$</span>values))])</span>
<span id="cb56-6"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb56-6" tabindex="-1"></a>lambda</span></code></pre></div>
<pre><code>## [1] 1.01942</code></pre>
<ul>
<li>If \(\lambda &gt; 1\): growth (on average) per time step<br />
</li>
<li>If \(\lambda = 1\): stationary<br />
</li>
<li>If \(\lambda &lt; 1\): decline</li>
</ul>
</div>
<div id="simulation-adding-stochasticity-and-management-actions" class="section level2 hasAnchor" number="15.12">
<h2><span class="header-section-number">15.12</span> Simulation: adding stochasticity and management actions<a href="matrix-population-models-mpms-projection-and-simulation.html#simulation-adding-stochasticity-and-management-actions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Deterministic projection treats the model output as exact expectations. In reality:</p>
<ul>
<li>births and deaths vary (demographic stochasticity),</li>
<li>vital rates vary across years (environmental stochasticity),</li>
<li>management can intervene (culling, supplementation, etc.).</li>
</ul>
<p>Below is a transparent stochastic simulation that:</p>
<ul>
<li>simulates reproduction with Poisson variation,</li>
<li>simulates survival/transitions with binomial variation,</li>
<li>allows a simple <strong>culling</strong> intervention.</li>
</ul>
<div id="one-simulated-trajectory-no-culling" class="section level3 hasAnchor" number="15.12.1">
<h3><span class="header-section-number">15.12.1</span> One simulated trajectory (no culling)<a href="matrix-population-models-mpms-projection-and-simulation.html#one-simulated-trajectory-no-culling" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Here we write the simulation as a sequence of explicit steps.</p>
<ol style="list-style-type: decimal">
<li>Create an output matrix (<code>sim1</code>) with one row per year and one column per stage.</li>
<li>Fill row 1 with the initial stage abundances (<code>n0</code>).</li>
<li>For each year, read the current stage counts (<code>J</code>, <code>S</code>, <code>A</code>).</li>
<li>Draw the number of births and transitions using random distributions:
<ul>
<li>births from adults: Poisson</li>
<li>survival/transition events: Binomial</li>
</ul></li>
<li>Write the resulting stage counts into the next row.</li>
<li>After the loop, plot total abundance through time.</li>
</ol>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb58-1" tabindex="-1"></a><span class="co"># Step 1: create a matrix to store the trajectory</span></span>
<span id="cb58-2"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb58-2" tabindex="-1"></a>sim1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span><span class="dt">L</span>, <span class="at">nrow =</span> years <span class="sc">+</span> <span class="dv">1</span>, <span class="at">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb58-3"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb58-3" tabindex="-1"></a><span class="fu">colnames</span>(sim1) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Juvenile&quot;</span>, <span class="st">&quot;Subadult&quot;</span>, <span class="st">&quot;Adult&quot;</span>)</span>
<span id="cb58-4"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb58-4" tabindex="-1"></a></span>
<span id="cb58-5"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb58-5" tabindex="-1"></a><span class="co"># Step 2: set the initial population (year 0)</span></span>
<span id="cb58-6"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb58-6" tabindex="-1"></a>sim1[<span class="dv">1</span>, ] <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(n0[<span class="fu">c</span>(<span class="st">&quot;Juvenile&quot;</span>, <span class="st">&quot;Subadult&quot;</span>, <span class="st">&quot;Adult&quot;</span>)])</span>
<span id="cb58-7"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb58-7" tabindex="-1"></a></span>
<span id="cb58-8"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb58-8" tabindex="-1"></a><span class="co"># Step 3-5: update the population one year at a time</span></span>
<span id="cb58-9"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb58-9" tabindex="-1"></a><span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>years) {</span>
<span id="cb58-10"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb58-10" tabindex="-1"></a>  <span class="co"># Current stage abundances at year t</span></span>
<span id="cb58-11"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb58-11" tabindex="-1"></a>  J <span class="ot">&lt;-</span> sim1[t, <span class="st">&quot;Juvenile&quot;</span>]</span>
<span id="cb58-12"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb58-12" tabindex="-1"></a>  S <span class="ot">&lt;-</span> sim1[t, <span class="st">&quot;Subadult&quot;</span>]</span>
<span id="cb58-13"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb58-13" tabindex="-1"></a>  A <span class="ot">&lt;-</span> sim1[t, <span class="st">&quot;Adult&quot;</span>]</span>
<span id="cb58-14"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb58-14" tabindex="-1"></a></span>
<span id="cb58-15"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb58-15" tabindex="-1"></a>  <span class="co"># Births: each adult contributes recruits stochastically</span></span>
<span id="cb58-16"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb58-16" tabindex="-1"></a>  newJ <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="dv">1</span>, <span class="at">lambda =</span> F_A <span class="sc">*</span> A)</span>
<span id="cb58-17"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb58-17" tabindex="-1"></a></span>
<span id="cb58-18"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb58-18" tabindex="-1"></a>  <span class="co"># Juvenile -&gt; Subadult transition</span></span>
<span id="cb58-19"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb58-19" tabindex="-1"></a>  J_to_S <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="at">size =</span> J, <span class="at">prob =</span> G_J)</span>
<span id="cb58-20"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb58-20" tabindex="-1"></a></span>
<span id="cb58-21"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb58-21" tabindex="-1"></a>  <span class="co"># Subadult transitions: stay subadult or move to adult</span></span>
<span id="cb58-22"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb58-22" tabindex="-1"></a>  S_stay <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="at">size =</span> S, <span class="at">prob =</span> P_S)</span>
<span id="cb58-23"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb58-23" tabindex="-1"></a>  S_remaining <span class="ot">&lt;-</span> S <span class="sc">-</span> S_stay</span>
<span id="cb58-24"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb58-24" tabindex="-1"></a>  p_grow_cond <span class="ot">&lt;-</span> <span class="cf">if</span> ((<span class="dv">1</span> <span class="sc">-</span> P_S) <span class="sc">&gt;</span> <span class="dv">0</span>) G_S <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> P_S) <span class="cf">else</span> <span class="dv">0</span></span>
<span id="cb58-25"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb58-25" tabindex="-1"></a>  S_to_A <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="at">size =</span> S_remaining, <span class="at">prob =</span> p_grow_cond)</span>
<span id="cb58-26"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb58-26" tabindex="-1"></a></span>
<span id="cb58-27"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb58-27" tabindex="-1"></a>  <span class="co"># Adult survival</span></span>
<span id="cb58-28"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb58-28" tabindex="-1"></a>  A_surv <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="at">size =</span> A, <span class="at">prob =</span> P_A)</span>
<span id="cb58-29"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb58-29" tabindex="-1"></a></span>
<span id="cb58-30"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb58-30" tabindex="-1"></a>  <span class="co"># Write next year&#39;s abundances</span></span>
<span id="cb58-31"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb58-31" tabindex="-1"></a>  sim1[t <span class="sc">+</span> <span class="dv">1</span>, <span class="st">&quot;Juvenile&quot;</span>] <span class="ot">&lt;-</span> newJ</span>
<span id="cb58-32"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb58-32" tabindex="-1"></a>  sim1[t <span class="sc">+</span> <span class="dv">1</span>, <span class="st">&quot;Subadult&quot;</span>] <span class="ot">&lt;-</span> J_to_S <span class="sc">+</span> S_stay</span>
<span id="cb58-33"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb58-33" tabindex="-1"></a>  sim1[t <span class="sc">+</span> <span class="dv">1</span>, <span class="st">&quot;Adult&quot;</span>] <span class="ot">&lt;-</span> S_to_A <span class="sc">+</span> A_surv</span>
<span id="cb58-34"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb58-34" tabindex="-1"></a>}</span>
<span id="cb58-35"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb58-35" tabindex="-1"></a></span>
<span id="cb58-36"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb58-36" tabindex="-1"></a><span class="co"># Step 6: plot the total population trajectory</span></span>
<span id="cb58-37"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb58-37" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">0</span><span class="sc">:</span>years, <span class="fu">rowSums</span>(sim1), <span class="at">type =</span> <span class="st">&quot;l&quot;</span>,</span>
<span id="cb58-38"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb58-38" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Year&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Total population size (simulated)&quot;</span>)</span></code></pre></div>
<p><img src="BB512_files/figure-html/mpm_sim_no_cull-1.png" alt="" width="672" /></p>
<p>Just after running the simulation, we can calculate the realised <code>lambda</code> for this no-culling trajectory.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb59-1" tabindex="-1"></a>tot_no <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(sim1)</span>
<span id="cb59-2"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb59-2" tabindex="-1"></a>realised_lambda_no <span class="ot">&lt;-</span> <span class="cf">if</span> (<span class="fu">length</span>(tot_no) <span class="sc">&lt;</span> <span class="dv">2</span> <span class="sc">||</span> tot_no[<span class="dv">1</span>] <span class="sc">&lt;=</span> <span class="dv">0</span>) {</span>
<span id="cb59-3"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb59-3" tabindex="-1"></a>  <span class="cn">NA_real_</span></span>
<span id="cb59-4"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb59-4" tabindex="-1"></a>} <span class="cf">else</span> <span class="cf">if</span> (<span class="fu">any</span>(tot_no <span class="sc">&lt;=</span> <span class="dv">0</span>)) {</span>
<span id="cb59-5"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb59-5" tabindex="-1"></a>  <span class="dv">0</span></span>
<span id="cb59-6"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb59-6" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb59-7"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb59-7" tabindex="-1"></a>  <span class="fu">exp</span>(<span class="fu">mean</span>(<span class="fu">diff</span>(<span class="fu">log</span>(tot_no))))</span>
<span id="cb59-8"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb59-8" tabindex="-1"></a>}</span>
<span id="cb59-9"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb59-9" tabindex="-1"></a>realised_lambda_no</span></code></pre></div>
<pre><code>## [1] 1.029897</code></pre>
</div>
<div id="add-a-culling-intervention" class="section level3 hasAnchor" number="15.12.2">
<h3><span class="header-section-number">15.12.2</span> Add a culling intervention<a href="matrix-population-models-mpms-projection-and-simulation.html#add-a-culling-intervention" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Example: remove 5 adults per year starting at year 10.
This section uses the same simulation rules as before, but adds a management step at the start of each year.</p>
<p>What happens:</p>
<ol style="list-style-type: decimal">
<li>Scenario A (no culling) was simulated in the previous section and stored as <code>sim1</code>.</li>
<li>We set intervention controls (<code>cull_enabled</code>, <code>cull_stage</code>, <code>cull_start_year</code>, <code>cull_n</code>) for Scenario B.</li>
<li>At each year <code>t</code>, we first read current stage abundances (<code>J</code>, <code>S</code>, <code>A</code>).</li>
<li>If culling is active and <code>t</code> is at/after the start year, we remove individuals from the target stage.</li>
<li>We then refresh <code>J</code>, <code>S</code>, <code>A</code> so births and survival are based on the post-cull population.</li>
<li>After that, demographic updates are exactly the same as in Scenario A.</li>
<li>Finally, we compare Scenario A and B in one figure and compute realised growth rates.</li>
</ol>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb61-1" tabindex="-1"></a><span class="co"># Management settings for the intervention scenario</span></span>
<span id="cb61-2"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb61-2" tabindex="-1"></a>cull_enabled <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb61-3"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb61-3" tabindex="-1"></a>cull_stage <span class="ot">&lt;-</span> <span class="st">&quot;Adult&quot;</span></span>
<span id="cb61-4"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb61-4" tabindex="-1"></a>cull_start_year <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb61-5"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb61-5" tabindex="-1"></a>cull_n <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb61-6"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb61-6" tabindex="-1"></a></span>
<span id="cb61-7"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb61-7" tabindex="-1"></a><span class="co"># Storage for the culling trajectory</span></span>
<span id="cb61-8"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb61-8" tabindex="-1"></a>sim_cull <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span><span class="dt">L</span>, <span class="at">nrow =</span> years <span class="sc">+</span> <span class="dv">1</span>, <span class="at">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb61-9"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb61-9" tabindex="-1"></a><span class="fu">colnames</span>(sim_cull) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Juvenile&quot;</span>, <span class="st">&quot;Subadult&quot;</span>, <span class="st">&quot;Adult&quot;</span>)</span>
<span id="cb61-10"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb61-10" tabindex="-1"></a>sim_cull[<span class="dv">1</span>, ] <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(n0[<span class="fu">c</span>(<span class="st">&quot;Juvenile&quot;</span>, <span class="st">&quot;Subadult&quot;</span>, <span class="st">&quot;Adult&quot;</span>)])</span>
<span id="cb61-11"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb61-11" tabindex="-1"></a></span>
<span id="cb61-12"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb61-12" tabindex="-1"></a><span class="co"># Simulate year by year, applying culling before demographic updates</span></span>
<span id="cb61-13"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb61-13" tabindex="-1"></a><span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>years) {</span>
<span id="cb61-14"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb61-14" tabindex="-1"></a>  <span class="co"># Current stage abundances at year t</span></span>
<span id="cb61-15"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb61-15" tabindex="-1"></a>  J <span class="ot">&lt;-</span> sim_cull[t, <span class="st">&quot;Juvenile&quot;</span>]</span>
<span id="cb61-16"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb61-16" tabindex="-1"></a>  S <span class="ot">&lt;-</span> sim_cull[t, <span class="st">&quot;Subadult&quot;</span>]</span>
<span id="cb61-17"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb61-17" tabindex="-1"></a>  A <span class="ot">&lt;-</span> sim_cull[t, <span class="st">&quot;Adult&quot;</span>]</span>
<span id="cb61-18"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb61-18" tabindex="-1"></a></span>
<span id="cb61-19"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb61-19" tabindex="-1"></a>  <span class="co"># Apply culling before births/survival if intervention is active</span></span>
<span id="cb61-20"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb61-20" tabindex="-1"></a>  <span class="cf">if</span> (cull_enabled <span class="sc">&amp;&amp;</span> t <span class="sc">&gt;=</span> cull_start_year) {</span>
<span id="cb61-21"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb61-21" tabindex="-1"></a>    <span class="co"># Never remove more individuals than are currently present</span></span>
<span id="cb61-22"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb61-22" tabindex="-1"></a>    remove_n <span class="ot">&lt;-</span> <span class="fu">min</span>(sim_cull[t, cull_stage], <span class="fu">as.integer</span>(cull_n))</span>
<span id="cb61-23"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb61-23" tabindex="-1"></a>    sim_cull[t, cull_stage] <span class="ot">&lt;-</span> sim_cull[t, cull_stage] <span class="sc">-</span> remove_n</span>
<span id="cb61-24"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb61-24" tabindex="-1"></a></span>
<span id="cb61-25"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb61-25" tabindex="-1"></a>    <span class="co"># Refresh stage counts after culling</span></span>
<span id="cb61-26"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb61-26" tabindex="-1"></a>    J <span class="ot">&lt;-</span> sim_cull[t, <span class="st">&quot;Juvenile&quot;</span>]</span>
<span id="cb61-27"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb61-27" tabindex="-1"></a>    S <span class="ot">&lt;-</span> sim_cull[t, <span class="st">&quot;Subadult&quot;</span>]</span>
<span id="cb61-28"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb61-28" tabindex="-1"></a>    A <span class="ot">&lt;-</span> sim_cull[t, <span class="st">&quot;Adult&quot;</span>]</span>
<span id="cb61-29"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb61-29" tabindex="-1"></a>  }</span>
<span id="cb61-30"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb61-30" tabindex="-1"></a></span>
<span id="cb61-31"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb61-31" tabindex="-1"></a>  <span class="co"># Demographic updates (same as the no-culling simulation)</span></span>
<span id="cb61-32"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb61-32" tabindex="-1"></a>  newJ <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="dv">1</span>, <span class="at">lambda =</span> F_A <span class="sc">*</span> A)</span>
<span id="cb61-33"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb61-33" tabindex="-1"></a>  J_to_S <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="at">size =</span> J, <span class="at">prob =</span> G_J)</span>
<span id="cb61-34"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb61-34" tabindex="-1"></a>  S_stay <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="at">size =</span> S, <span class="at">prob =</span> P_S)</span>
<span id="cb61-35"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb61-35" tabindex="-1"></a>  S_remaining <span class="ot">&lt;-</span> S <span class="sc">-</span> S_stay</span>
<span id="cb61-36"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb61-36" tabindex="-1"></a>  p_grow_cond <span class="ot">&lt;-</span> <span class="cf">if</span> ((<span class="dv">1</span> <span class="sc">-</span> P_S) <span class="sc">&gt;</span> <span class="dv">0</span>) G_S <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> P_S) <span class="cf">else</span> <span class="dv">0</span></span>
<span id="cb61-37"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb61-37" tabindex="-1"></a>  S_to_A <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="at">size =</span> S_remaining, <span class="at">prob =</span> p_grow_cond)</span>
<span id="cb61-38"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb61-38" tabindex="-1"></a>  A_surv <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="at">size =</span> A, <span class="at">prob =</span> P_A)</span>
<span id="cb61-39"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb61-39" tabindex="-1"></a></span>
<span id="cb61-40"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb61-40" tabindex="-1"></a>  sim_cull[t <span class="sc">+</span> <span class="dv">1</span>, <span class="st">&quot;Juvenile&quot;</span>] <span class="ot">&lt;-</span> newJ</span>
<span id="cb61-41"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb61-41" tabindex="-1"></a>  sim_cull[t <span class="sc">+</span> <span class="dv">1</span>, <span class="st">&quot;Subadult&quot;</span>] <span class="ot">&lt;-</span> J_to_S <span class="sc">+</span> S_stay</span>
<span id="cb61-42"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb61-42" tabindex="-1"></a>  sim_cull[t <span class="sc">+</span> <span class="dv">1</span>, <span class="st">&quot;Adult&quot;</span>] <span class="ot">&lt;-</span> S_to_A <span class="sc">+</span> A_surv</span>
<span id="cb61-43"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb61-43" tabindex="-1"></a>}</span>
<span id="cb61-44"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb61-44" tabindex="-1"></a></span>
<span id="cb61-45"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb61-45" tabindex="-1"></a><span class="co"># Compare trajectories: solid = no culling, dashed = culling</span></span>
<span id="cb61-46"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb61-46" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">0</span><span class="sc">:</span>years, <span class="fu">rowSums</span>(sim1), <span class="at">type =</span> <span class="st">&quot;l&quot;</span>,</span>
<span id="cb61-47"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb61-47" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Year&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Total population size&quot;</span>,</span>
<span id="cb61-48"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb61-48" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">range</span>(<span class="fu">c</span>(<span class="fu">rowSums</span>(sim1), <span class="fu">rowSums</span>(sim_cull))))</span>
<span id="cb61-49"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb61-49" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">0</span><span class="sc">:</span>years, <span class="fu">rowSums</span>(sim_cull), <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb61-50"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb61-50" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;No culling&quot;</span>, <span class="st">&quot;Culling: 5 adults/year from year 10&quot;</span>),</span>
<span id="cb61-51"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb61-51" tabindex="-1"></a>       <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<p><img src="BB512_files/figure-html/mpm_sim_with_cull-1.png" alt="" width="672" /></p>
<p>For this single-run summary, realised <code>lambda</code> is the geometric mean of year-to-year total-population growth factors. This is a finite-horizon, trajectory-specific estimate; in many ecology texts, the long-run stochastic growth rate is denoted \(\lambda_s\) (or \(\log \lambda_s\)), which is related but not identical to a single-run realised value.</p>
<p>Interpretation:</p>
<ul>
<li><code>lambda &gt; 1</code>: realised growth over the simulated period</li>
<li><code>0 &lt; lambda &lt; 1</code>: realised decline</li>
<li><code>lambda = 0</code>: extinction occurred at some point in the simulated period</li>
<li><code>lambda</code> should not be negative in this setting</li>
</ul>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb62-1" tabindex="-1"></a><span class="co"># Realised lambda from each simulated trajectory</span></span>
<span id="cb62-2"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb62-2" tabindex="-1"></a>tot_no <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(sim1)</span>
<span id="cb62-3"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb62-3" tabindex="-1"></a>tot_cu <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(sim_cull)</span>
<span id="cb62-4"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb62-4" tabindex="-1"></a></span>
<span id="cb62-5"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb62-5" tabindex="-1"></a><span class="co"># Geometric-mean per-step growth rate over the full horizon.</span></span>
<span id="cb62-6"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb62-6" tabindex="-1"></a><span class="co"># If a trajectory hits zero, define realised lambda as 0 (extinction within horizon).</span></span>
<span id="cb62-7"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb62-7" tabindex="-1"></a>realised_lambda_no <span class="ot">&lt;-</span> <span class="cf">if</span> (<span class="fu">length</span>(tot_no) <span class="sc">&lt;</span> <span class="dv">2</span> <span class="sc">||</span> tot_no[<span class="dv">1</span>] <span class="sc">&lt;=</span> <span class="dv">0</span>) {</span>
<span id="cb62-8"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb62-8" tabindex="-1"></a>  <span class="cn">NA_real_</span></span>
<span id="cb62-9"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb62-9" tabindex="-1"></a>} <span class="cf">else</span> <span class="cf">if</span> (<span class="fu">any</span>(tot_no <span class="sc">&lt;=</span> <span class="dv">0</span>)) {</span>
<span id="cb62-10"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb62-10" tabindex="-1"></a>  <span class="dv">0</span></span>
<span id="cb62-11"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb62-11" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb62-12"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb62-12" tabindex="-1"></a>  <span class="fu">exp</span>(<span class="fu">mean</span>(<span class="fu">diff</span>(<span class="fu">log</span>(tot_no))))</span>
<span id="cb62-13"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb62-13" tabindex="-1"></a>}</span>
<span id="cb62-14"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb62-14" tabindex="-1"></a></span>
<span id="cb62-15"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb62-15" tabindex="-1"></a>realised_lambda_cu <span class="ot">&lt;-</span> <span class="cf">if</span> (<span class="fu">length</span>(tot_cu) <span class="sc">&lt;</span> <span class="dv">2</span> <span class="sc">||</span> tot_cu[<span class="dv">1</span>] <span class="sc">&lt;=</span> <span class="dv">0</span>) {</span>
<span id="cb62-16"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb62-16" tabindex="-1"></a>  <span class="cn">NA_real_</span></span>
<span id="cb62-17"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb62-17" tabindex="-1"></a>} <span class="cf">else</span> <span class="cf">if</span> (<span class="fu">any</span>(tot_cu <span class="sc">&lt;=</span> <span class="dv">0</span>)) {</span>
<span id="cb62-18"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb62-18" tabindex="-1"></a>  <span class="dv">0</span></span>
<span id="cb62-19"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb62-19" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb62-20"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb62-20" tabindex="-1"></a>  <span class="fu">exp</span>(<span class="fu">mean</span>(<span class="fu">diff</span>(<span class="fu">log</span>(tot_cu))))</span>
<span id="cb62-21"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb62-21" tabindex="-1"></a>}</span>
<span id="cb62-22"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb62-22" tabindex="-1"></a></span>
<span id="cb62-23"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb62-23" tabindex="-1"></a><span class="fu">data.frame</span>(</span>
<span id="cb62-24"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb62-24" tabindex="-1"></a>  <span class="at">scenario =</span> <span class="fu">c</span>(<span class="st">&quot;No culling&quot;</span>, <span class="st">&quot;Culling&quot;</span>),</span>
<span id="cb62-25"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb62-25" tabindex="-1"></a>  <span class="at">realised_lambda =</span> <span class="fu">c</span>(realised_lambda_no, realised_lambda_cu)</span>
<span id="cb62-26"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb62-26" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>##     scenario realised_lambda
## 1 No culling        1.029897
## 2    Culling        0.000000</code></pre>
</div>
<div id="many-replicates-uncertainty-bands" class="section level3 hasAnchor" number="15.12.3">
<h3><span class="header-section-number">15.12.3</span> Many replicates (uncertainty bands)<a href="matrix-population-models-mpms-projection-and-simulation.html#many-replicates-uncertainty-bands" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A single run is one possible realisation. We typically run many replicates and summarise.
In this script, we run two sets of replicates (no culling vs culling), then compute median and 10-90% intervals for each year.
Note: different studies may use different interval widths (for example, 95% intervals) depending on purpose and reporting conventions.
To keep the comparison clear, the code is structured as:
1. Scenario A: run all replicates with no culling.
2. Scenario B: run all replicates with culling.
3. Compare Scenario A and B in one graph.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-1" tabindex="-1"></a><span class="co"># Number of Monte Carlo replicates</span></span>
<span id="cb64-2"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-2" tabindex="-1"></a>nreps <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb64-3"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-3" tabindex="-1"></a></span>
<span id="cb64-4"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-4" tabindex="-1"></a><span class="co"># Store total abundance per year for each replicate</span></span>
<span id="cb64-5"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-5" tabindex="-1"></a>totals_no <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA_real_</span>, <span class="at">nrow =</span> years <span class="sc">+</span> <span class="dv">1</span>, <span class="at">ncol =</span> nreps)</span>
<span id="cb64-6"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-6" tabindex="-1"></a>totals_cull <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA_real_</span>, <span class="at">nrow =</span> years <span class="sc">+</span> <span class="dv">1</span>, <span class="at">ncol =</span> nreps)</span>
<span id="cb64-7"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-7" tabindex="-1"></a></span>
<span id="cb64-8"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-8" tabindex="-1"></a><span class="co"># Scenario A: run all replicates with no culling</span></span>
<span id="cb64-9"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-9" tabindex="-1"></a><span class="cf">for</span> (rep <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nreps) {</span>
<span id="cb64-10"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-10" tabindex="-1"></a>  out_no <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span><span class="dt">L</span>, <span class="at">nrow =</span> years <span class="sc">+</span> <span class="dv">1</span>, <span class="at">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb64-11"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-11" tabindex="-1"></a>  <span class="fu">colnames</span>(out_no) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Juvenile&quot;</span>, <span class="st">&quot;Subadult&quot;</span>, <span class="st">&quot;Adult&quot;</span>)</span>
<span id="cb64-12"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-12" tabindex="-1"></a>  out_no[<span class="dv">1</span>, ] <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(n0[<span class="fu">c</span>(<span class="st">&quot;Juvenile&quot;</span>, <span class="st">&quot;Subadult&quot;</span>, <span class="st">&quot;Adult&quot;</span>)])</span>
<span id="cb64-13"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-13" tabindex="-1"></a></span>
<span id="cb64-14"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-14" tabindex="-1"></a>  <span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>years) {</span>
<span id="cb64-15"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-15" tabindex="-1"></a>    J <span class="ot">&lt;-</span> out_no[t, <span class="st">&quot;Juvenile&quot;</span>]</span>
<span id="cb64-16"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-16" tabindex="-1"></a>    S <span class="ot">&lt;-</span> out_no[t, <span class="st">&quot;Subadult&quot;</span>]</span>
<span id="cb64-17"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-17" tabindex="-1"></a>    A <span class="ot">&lt;-</span> out_no[t, <span class="st">&quot;Adult&quot;</span>]</span>
<span id="cb64-18"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-18" tabindex="-1"></a></span>
<span id="cb64-19"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-19" tabindex="-1"></a>    newJ <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="dv">1</span>, <span class="at">lambda =</span> F_A <span class="sc">*</span> A)</span>
<span id="cb64-20"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-20" tabindex="-1"></a>    J_to_S <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="at">size =</span> J, <span class="at">prob =</span> G_J)</span>
<span id="cb64-21"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-21" tabindex="-1"></a>    S_stay <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="at">size =</span> S, <span class="at">prob =</span> P_S)</span>
<span id="cb64-22"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-22" tabindex="-1"></a>    S_remaining <span class="ot">&lt;-</span> S <span class="sc">-</span> S_stay</span>
<span id="cb64-23"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-23" tabindex="-1"></a>    p_grow_cond <span class="ot">&lt;-</span> <span class="cf">if</span> ((<span class="dv">1</span> <span class="sc">-</span> P_S) <span class="sc">&gt;</span> <span class="dv">0</span>) G_S <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> P_S) <span class="cf">else</span> <span class="dv">0</span></span>
<span id="cb64-24"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-24" tabindex="-1"></a>    S_to_A <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="at">size =</span> S_remaining, <span class="at">prob =</span> p_grow_cond)</span>
<span id="cb64-25"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-25" tabindex="-1"></a>    A_surv <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="at">size =</span> A, <span class="at">prob =</span> P_A)</span>
<span id="cb64-26"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-26" tabindex="-1"></a></span>
<span id="cb64-27"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-27" tabindex="-1"></a>    out_no[t <span class="sc">+</span> <span class="dv">1</span>, <span class="st">&quot;Juvenile&quot;</span>] <span class="ot">&lt;-</span> newJ</span>
<span id="cb64-28"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-28" tabindex="-1"></a>    out_no[t <span class="sc">+</span> <span class="dv">1</span>, <span class="st">&quot;Subadult&quot;</span>] <span class="ot">&lt;-</span> J_to_S <span class="sc">+</span> S_stay</span>
<span id="cb64-29"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-29" tabindex="-1"></a>    out_no[t <span class="sc">+</span> <span class="dv">1</span>, <span class="st">&quot;Adult&quot;</span>] <span class="ot">&lt;-</span> S_to_A <span class="sc">+</span> A_surv</span>
<span id="cb64-30"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-30" tabindex="-1"></a>  }</span>
<span id="cb64-31"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-31" tabindex="-1"></a>  totals_no[, rep] <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(out_no)</span>
<span id="cb64-32"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-32" tabindex="-1"></a>}</span>
<span id="cb64-33"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-33" tabindex="-1"></a></span>
<span id="cb64-34"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-34" tabindex="-1"></a><span class="co"># Scenario B: run all replicates with culling</span></span>
<span id="cb64-35"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-35" tabindex="-1"></a><span class="cf">for</span> (rep <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nreps) {</span>
<span id="cb64-36"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-36" tabindex="-1"></a>  out_cu <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span><span class="dt">L</span>, <span class="at">nrow =</span> years <span class="sc">+</span> <span class="dv">1</span>, <span class="at">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb64-37"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-37" tabindex="-1"></a>  <span class="fu">colnames</span>(out_cu) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Juvenile&quot;</span>, <span class="st">&quot;Subadult&quot;</span>, <span class="st">&quot;Adult&quot;</span>)</span>
<span id="cb64-38"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-38" tabindex="-1"></a>  out_cu[<span class="dv">1</span>, ] <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(n0[<span class="fu">c</span>(<span class="st">&quot;Juvenile&quot;</span>, <span class="st">&quot;Subadult&quot;</span>, <span class="st">&quot;Adult&quot;</span>)])</span>
<span id="cb64-39"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-39" tabindex="-1"></a></span>
<span id="cb64-40"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-40" tabindex="-1"></a>  <span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>years) {</span>
<span id="cb64-41"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-41" tabindex="-1"></a>    J <span class="ot">&lt;-</span> out_cu[t, <span class="st">&quot;Juvenile&quot;</span>]</span>
<span id="cb64-42"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-42" tabindex="-1"></a>    S <span class="ot">&lt;-</span> out_cu[t, <span class="st">&quot;Subadult&quot;</span>]</span>
<span id="cb64-43"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-43" tabindex="-1"></a>    A <span class="ot">&lt;-</span> out_cu[t, <span class="st">&quot;Adult&quot;</span>]</span>
<span id="cb64-44"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-44" tabindex="-1"></a></span>
<span id="cb64-45"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-45" tabindex="-1"></a>    <span class="cf">if</span> (cull_enabled <span class="sc">&amp;&amp;</span> t <span class="sc">&gt;=</span> cull_start_year) {</span>
<span id="cb64-46"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-46" tabindex="-1"></a>      remove_n <span class="ot">&lt;-</span> <span class="fu">min</span>(out_cu[t, cull_stage], <span class="fu">as.integer</span>(cull_n))</span>
<span id="cb64-47"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-47" tabindex="-1"></a>      out_cu[t, cull_stage] <span class="ot">&lt;-</span> out_cu[t, cull_stage] <span class="sc">-</span> remove_n</span>
<span id="cb64-48"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-48" tabindex="-1"></a>      J <span class="ot">&lt;-</span> out_cu[t, <span class="st">&quot;Juvenile&quot;</span>]</span>
<span id="cb64-49"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-49" tabindex="-1"></a>      S <span class="ot">&lt;-</span> out_cu[t, <span class="st">&quot;Subadult&quot;</span>]</span>
<span id="cb64-50"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-50" tabindex="-1"></a>      A <span class="ot">&lt;-</span> out_cu[t, <span class="st">&quot;Adult&quot;</span>]</span>
<span id="cb64-51"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-51" tabindex="-1"></a>    }</span>
<span id="cb64-52"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-52" tabindex="-1"></a></span>
<span id="cb64-53"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-53" tabindex="-1"></a>    newJ <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="dv">1</span>, <span class="at">lambda =</span> F_A <span class="sc">*</span> A)</span>
<span id="cb64-54"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-54" tabindex="-1"></a>    J_to_S <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="at">size =</span> J, <span class="at">prob =</span> G_J)</span>
<span id="cb64-55"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-55" tabindex="-1"></a>    S_stay <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="at">size =</span> S, <span class="at">prob =</span> P_S)</span>
<span id="cb64-56"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-56" tabindex="-1"></a>    S_remaining <span class="ot">&lt;-</span> S <span class="sc">-</span> S_stay</span>
<span id="cb64-57"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-57" tabindex="-1"></a>    p_grow_cond <span class="ot">&lt;-</span> <span class="cf">if</span> ((<span class="dv">1</span> <span class="sc">-</span> P_S) <span class="sc">&gt;</span> <span class="dv">0</span>) G_S <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> P_S) <span class="cf">else</span> <span class="dv">0</span></span>
<span id="cb64-58"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-58" tabindex="-1"></a>    S_to_A <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="at">size =</span> S_remaining, <span class="at">prob =</span> p_grow_cond)</span>
<span id="cb64-59"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-59" tabindex="-1"></a>    A_surv <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="at">size =</span> A, <span class="at">prob =</span> P_A)</span>
<span id="cb64-60"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-60" tabindex="-1"></a></span>
<span id="cb64-61"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-61" tabindex="-1"></a>    out_cu[t <span class="sc">+</span> <span class="dv">1</span>, <span class="st">&quot;Juvenile&quot;</span>] <span class="ot">&lt;-</span> newJ</span>
<span id="cb64-62"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-62" tabindex="-1"></a>    out_cu[t <span class="sc">+</span> <span class="dv">1</span>, <span class="st">&quot;Subadult&quot;</span>] <span class="ot">&lt;-</span> J_to_S <span class="sc">+</span> S_stay</span>
<span id="cb64-63"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-63" tabindex="-1"></a>    out_cu[t <span class="sc">+</span> <span class="dv">1</span>, <span class="st">&quot;Adult&quot;</span>] <span class="ot">&lt;-</span> S_to_A <span class="sc">+</span> A_surv</span>
<span id="cb64-64"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-64" tabindex="-1"></a>  }</span>
<span id="cb64-65"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-65" tabindex="-1"></a>  totals_cull[, rep] <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(out_cu)</span>
<span id="cb64-66"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-66" tabindex="-1"></a>}</span>
<span id="cb64-67"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-67" tabindex="-1"></a></span>
<span id="cb64-68"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-68" tabindex="-1"></a><span class="co"># Summarise each year across replicates (median and 10-90% interval)</span></span>
<span id="cb64-69"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-69" tabindex="-1"></a>sum_no <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb64-70"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-70" tabindex="-1"></a>  <span class="at">year =</span> <span class="dv">0</span><span class="sc">:</span>years,</span>
<span id="cb64-71"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-71" tabindex="-1"></a>  <span class="at">median =</span> <span class="fu">apply</span>(totals_no, <span class="dv">1</span>, median),</span>
<span id="cb64-72"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-72" tabindex="-1"></a>  <span class="at">lo =</span> <span class="fu">apply</span>(totals_no, <span class="dv">1</span>, quantile, <span class="at">probs =</span> <span class="fl">0.1</span>),</span>
<span id="cb64-73"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-73" tabindex="-1"></a>  <span class="at">hi =</span> <span class="fu">apply</span>(totals_no, <span class="dv">1</span>, quantile, <span class="at">probs =</span> <span class="fl">0.9</span>)</span>
<span id="cb64-74"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-74" tabindex="-1"></a>)</span>
<span id="cb64-75"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-75" tabindex="-1"></a>sum_cu <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb64-76"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-76" tabindex="-1"></a>  <span class="at">year =</span> <span class="dv">0</span><span class="sc">:</span>years,</span>
<span id="cb64-77"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-77" tabindex="-1"></a>  <span class="at">median =</span> <span class="fu">apply</span>(totals_cull, <span class="dv">1</span>, median),</span>
<span id="cb64-78"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-78" tabindex="-1"></a>  <span class="at">lo =</span> <span class="fu">apply</span>(totals_cull, <span class="dv">1</span>, quantile, <span class="at">probs =</span> <span class="fl">0.1</span>),</span>
<span id="cb64-79"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-79" tabindex="-1"></a>  <span class="at">hi =</span> <span class="fu">apply</span>(totals_cull, <span class="dv">1</span>, quantile, <span class="at">probs =</span> <span class="fl">0.9</span>)</span>
<span id="cb64-80"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-80" tabindex="-1"></a>)</span>
<span id="cb64-81"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-81" tabindex="-1"></a></span>
<span id="cb64-82"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-82" tabindex="-1"></a><span class="co"># Scenario A vs Scenario B: compare summaries in one figure</span></span>
<span id="cb64-83"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-83" tabindex="-1"></a><span class="fu">plot</span>(sum_no<span class="sc">$</span>year, sum_no<span class="sc">$</span>median, <span class="at">type =</span> <span class="st">&quot;n&quot;</span>,</span>
<span id="cb64-84"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-84" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Year&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Total population size&quot;</span>,</span>
<span id="cb64-85"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-85" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">range</span>(<span class="fu">c</span>(sum_no<span class="sc">$</span>lo, sum_no<span class="sc">$</span>hi, sum_cu<span class="sc">$</span>lo, sum_cu<span class="sc">$</span>hi)))</span>
<span id="cb64-86"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-86" tabindex="-1"></a></span>
<span id="cb64-87"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-87" tabindex="-1"></a><span class="co"># Ribbon for no-culling uncertainty (10-90%)</span></span>
<span id="cb64-88"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-88" tabindex="-1"></a><span class="fu">polygon</span>(</span>
<span id="cb64-89"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-89" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">c</span>(sum_no<span class="sc">$</span>year, <span class="fu">rev</span>(sum_no<span class="sc">$</span>year)),</span>
<span id="cb64-90"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-90" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">c</span>(sum_no<span class="sc">$</span>lo, <span class="fu">rev</span>(sum_no<span class="sc">$</span>hi)),</span>
<span id="cb64-91"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-91" tabindex="-1"></a>  <span class="at">col =</span> grDevices<span class="sc">::</span><span class="fu">adjustcolor</span>(<span class="st">&quot;steelblue&quot;</span>, <span class="at">alpha.f =</span> <span class="fl">0.25</span>),</span>
<span id="cb64-92"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-92" tabindex="-1"></a>  <span class="at">border =</span> <span class="cn">NA</span></span>
<span id="cb64-93"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-93" tabindex="-1"></a>)</span>
<span id="cb64-94"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-94" tabindex="-1"></a></span>
<span id="cb64-95"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-95" tabindex="-1"></a><span class="co"># Ribbon for culling uncertainty (10-90%)</span></span>
<span id="cb64-96"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-96" tabindex="-1"></a><span class="fu">polygon</span>(</span>
<span id="cb64-97"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-97" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">c</span>(sum_cu<span class="sc">$</span>year, <span class="fu">rev</span>(sum_cu<span class="sc">$</span>year)),</span>
<span id="cb64-98"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-98" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">c</span>(sum_cu<span class="sc">$</span>lo, <span class="fu">rev</span>(sum_cu<span class="sc">$</span>hi)),</span>
<span id="cb64-99"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-99" tabindex="-1"></a>  <span class="at">col =</span> grDevices<span class="sc">::</span><span class="fu">adjustcolor</span>(<span class="st">&quot;firebrick&quot;</span>, <span class="at">alpha.f =</span> <span class="fl">0.25</span>),</span>
<span id="cb64-100"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-100" tabindex="-1"></a>  <span class="at">border =</span> <span class="cn">NA</span></span>
<span id="cb64-101"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-101" tabindex="-1"></a>)</span>
<span id="cb64-102"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-102" tabindex="-1"></a></span>
<span id="cb64-103"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-103" tabindex="-1"></a><span class="co"># Median trajectories on top of ribbons</span></span>
<span id="cb64-104"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-104" tabindex="-1"></a><span class="fu">lines</span>(sum_no<span class="sc">$</span>year, sum_no<span class="sc">$</span>median, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;steelblue4&quot;</span>)</span>
<span id="cb64-105"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-105" tabindex="-1"></a><span class="fu">lines</span>(sum_cu<span class="sc">$</span>year, sum_cu<span class="sc">$</span>median, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;firebrick4&quot;</span>)</span>
<span id="cb64-106"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-106" tabindex="-1"></a></span>
<span id="cb64-107"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-107" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>,</span>
<span id="cb64-108"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-108" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;No culling (median)&quot;</span>, <span class="st">&quot;No culling (10-90%)&quot;</span>,</span>
<span id="cb64-109"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-109" tabindex="-1"></a>                  <span class="st">&quot;Culling (median)&quot;</span>, <span class="st">&quot;Culling (10-90%)&quot;</span>),</span>
<span id="cb64-110"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-110" tabindex="-1"></a>       <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="cn">NA</span>, <span class="dv">2</span>, <span class="cn">NA</span>),</span>
<span id="cb64-111"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-111" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="cn">NA</span>, <span class="dv">2</span>, <span class="cn">NA</span>),</span>
<span id="cb64-112"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-112" tabindex="-1"></a>       <span class="at">pch =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">15</span>, <span class="cn">NA</span>, <span class="dv">15</span>),</span>
<span id="cb64-113"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-113" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;steelblue4&quot;</span>, grDevices<span class="sc">::</span><span class="fu">adjustcolor</span>(<span class="st">&quot;steelblue&quot;</span>, <span class="at">alpha.f =</span> <span class="fl">0.5</span>),</span>
<span id="cb64-114"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-114" tabindex="-1"></a>               <span class="st">&quot;firebrick4&quot;</span>, grDevices<span class="sc">::</span><span class="fu">adjustcolor</span>(<span class="st">&quot;firebrick&quot;</span>, <span class="at">alpha.f =</span> <span class="fl">0.5</span>)),</span>
<span id="cb64-115"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-115" tabindex="-1"></a>       <span class="at">pt.cex =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">1.5</span>, <span class="dv">1</span>, <span class="fl">1.5</span>),</span>
<span id="cb64-116"><a href="matrix-population-models-mpms-projection-and-simulation.html#cb64-116" tabindex="-1"></a>       <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<p><img src="BB512_files/figure-html/mpm_sim_reps-1.png" alt="" width="672" /></p>
</div>
</div>
<div id="student-exercises-for-a-class-handout" class="section level2 hasAnchor" number="15.13">
<h2><span class="header-section-number">15.13</span> Student exercises (for a class handout)<a href="matrix-population-models-mpms-projection-and-simulation.html#student-exercises-for-a-class-handout" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="exercise-projection-interval-sanity-check" class="section level3 hasAnchor" number="15.13.1">
<h3><span class="header-section-number">15.13.1</span> Exercise: Projection interval sanity check<a href="matrix-population-models-mpms-projection-and-simulation.html#exercise-projection-interval-sanity-check" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: decimal">
<li>In the tutorial, \(\Delta t = 1\) year. Write one sentence explaining what that means.</li>
<li>Suppose you wanted \(\Delta t = 1\) month. What changes would you need to make to the interpretation of:
<ul>
<li>\(P_A\)?</li>
<li>\(F_A\)?</li>
</ul></li>
<li>Name one real reason you might prefer monthly time steps over yearly ones.</li>
</ol>
</div>
<div id="exercise-change-one-vital-rate-and-re-run-projections" class="section level3 hasAnchor" number="15.13.2">
<h3><span class="header-section-number">15.13.2</span> Exercise: Change one vital rate and re-run projections<a href="matrix-population-models-mpms-projection-and-simulation.html#exercise-change-one-vital-rate-and-re-run-projections" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: decimal">
<li>Reduce adult survival from \(P_A = 0.80\) to \(P_A = 0.70\). Recompute:
<ul>
<li>the deterministic projection plot,</li>
<li>\(\lambda\).</li>
</ul></li>
<li>Does the population grow or decline now? How can you tell?</li>
</ol>
</div>
<div id="exercise-culling-as-management" class="section level3 hasAnchor" number="15.13.3">
<h3><span class="header-section-number">15.13.3</span> Exercise: Culling as management<a href="matrix-population-models-mpms-projection-and-simulation.html#exercise-culling-as-management" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: decimal">
<li>In the simulation, cull 5 adults per year from year 10. Increase this to 10 adults per year.</li>
<li>Compare the median population trajectory and the uncertainty bands.</li>
<li>To identify which stage is most impactful, run the same culling intensity for each stage separately (juveniles, subadults, adults), then compare results. Which stage has the largest effect, and why?</li>
</ol>
</div>
<div id="exercise-contraception-treatment-reduced-fecundity" class="section level3 hasAnchor" number="15.13.4">
<h3><span class="header-section-number">15.13.4</span> Exercise: Contraception treatment (reduced fecundity)<a href="matrix-population-models-mpms-projection-and-simulation.html#exercise-contraception-treatment-reduced-fecundity" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Design a second management treatment where fecundity is reduced instead of removing individuals.</p>
<ol style="list-style-type: decimal">
<li>Keep survival/transition rates unchanged, but reduce fecundity after year 10 with a 90% effective contraceptive treatment (for example, multiply <code>F_A</code> by 0.1 from year 10 onward).</li>
<li>Implement this as a time-dependent fecundity value inside the yearly loop (for example, <code>F_A_t</code>), and use <code>F_A_t</code> in the births step.</li>
<li>Run replicate simulations for:
<ul>
<li>baseline (no treatment),</li>
<li>culling treatment,</li>
<li>contraception treatment.</li>
</ul></li>
<li>Compare all three scenarios in one figure and discuss which treatment gives the largest reduction in population growth.</li>
</ol>
</div>
</div>
<div id="notes-and-extensions" class="section level2 hasAnchor" number="15.14">
<h2><span class="header-section-number">15.14</span> Notes and extensions<a href="matrix-population-models-mpms-projection-and-simulation.html#notes-and-extensions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>If you include juvenile stasis (juveniles surviving but remaining juveniles), add a \(P_J\) term and include it in the matrix and simulation.</li>
<li>The deterministic matrix model is most useful for <em>structure</em> and <em>long-term behaviour</em> (\(\lambda\), stable stage structure, elasticities).</li>
<li>Stochastic simulations are most useful for <em>short-term variability</em> and <em>scenario exploration</em> (management, uncertainty, risk).</li>
</ul>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="trade-offs-and-the-declining-force-of-selection.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="part-3.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": "https://github.com/jonesor/BB512_Book/edit/master/2_12_MPMIntroAndSimulation.Rmd",
    "text": "Edit"
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": ["BB512.pdf"],
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "section"
  },
  "split_by": "section"
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
